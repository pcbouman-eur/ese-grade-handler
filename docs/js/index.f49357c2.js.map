{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/SelectColumn.vue?dea1","webpack:///./src/App.vue?3f40","webpack:///./src/components/Welcome.vue?d0b0","webpack:///src/components/Welcome.vue","webpack:///./src/components/Welcome.vue?c247","webpack:///./src/components/Welcome.vue?a463","webpack:///./src/components/Combiner.vue?8528","webpack:///./src/util/sheetToDataframe.js","webpack:///./src/util/IdentityConfig.js","webpack:///./src/util/processWorkbook.js","webpack:///./src/util/exportColumns.js","webpack:///./src/components/AttendancePanel.vue?aac1","webpack:///src/components/AttendancePanel.vue","webpack:///./src/components/AttendancePanel.vue?9484","webpack:///./src/components/AttendancePanel.vue?877e","webpack:///./src/components/SelectColumn.vue?a1e6","webpack:///src/components/SelectColumn.vue","webpack:///./src/components/SelectColumn.vue?9a8c","webpack:///./src/components/SelectColumn.vue?8486","webpack:///./src/components/ConditionPanel.vue?f2f7","webpack:///./src/util/ConditionOptions.js","webpack:///src/components/ConditionPanel.vue","webpack:///./src/components/ConditionPanel.vue?b9f7","webpack:///./src/components/ConditionPanel.vue?6131","webpack:///src/components/Combiner.vue","webpack:///./src/components/Combiner.vue?ab16","webpack:///./src/components/Combiner.vue?265e","webpack:///./src/components/Injector.vue?2d7f","webpack:///./src/util/GradingPolicy.js","webpack:///./src/util/injectResults.js","webpack:///src/components/Injector.vue","webpack:///./src/components/Injector.vue?b181","webpack:///./src/components/Injector.vue?8ff6","webpack:///./src/components/Mutator.vue?0fda","webpack:///src/components/Mutator.vue","webpack:///./src/components/Mutator.vue?e5f9","webpack:///./src/components/Mutator.vue?c277","webpack:///src/App.vue","webpack:///./src/App.vue?3359","webpack:///./src/App.vue","webpack:///./src/plugins/vuetify.js","webpack:///./src/main.js","webpack:///./src/components/ConditionPanel.vue?4cca","webpack:///./src/components/Mutator.vue?9dc2","webpack:///./src/components/Injector.vue?95a9","webpack:///./src/components/Welcome.vue?5f2f","webpack:///./src/components/AttendancePanel.vue?54c2","webpack:///./src/components/Combiner.vue?dee5"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","on","refresh","model","callback","$$v","currentTab","expression","_e","staticRenderFns","staticStyle","component","VCol","VContainer","VRow","clickOpen","clickOpenCanvas","ref","fileChosen","canvasFileChosen","_l","book","filename","_s","frame","sheetName","$set","skipped","attendance","availableKeys","addOutputCol","cantExport","exportSheet","dropEmptyStudents","keyColumn","col","idx","availableColumns","outputColumns","filterLabel","addFilter","directives","rawName","updateFilter","sheetToDataframe","worksheet","header_index","data_index","range","XLSX","utils","decode_range","column_names","column_indices","R","e","C","cell_ref","encode_cell","header","v","toString","trim","row_data","add","val","df","DataFrame","columns","IdentityConfig","keyTypes","pattern","conversions","to","from","convert","fromType","toType","substr","preferredType","types","kt","includes","getPattern","obj","checkKeySpec","column","spec","keySet","Set","keyCol","el","String","matches","Array","matchAll","error","has","findKeyColumns","config","cols","colname","keySpec","type","keys","processWorkbook","workbook","frames","SheetNames","Sheets","undefined","err","console","log","CANVAS_SIS_COL","processCanvasWorkbook","query","is","inplace","USER_PATTERN","USER_PATTERN_HELP","SHEET_KEY","EXEMPTION_PATTERN","EXEMPTION_PATTERN_HELP","SESSION_PATTERN","FIRST_ROW","DEFAULT_MINIMUM_PERCENTAGE","findColumnByPattern","pat","values","match","processAttendanceWorkbook","attSheet","USER_KEY","EXEMPTION_KEY","userCol","exemptionCol","sessionKeys","sessionCols","duplicates","index","row","userName","exemption","sessionsPresent","ses","present","oldrec","stdNum","threshold","Math","ceil","sessions","extractKeys","outputKey","conv_spec","src_key","map","columnToDataset","allKeys","col_keys","col_data","pairs","forEach","th","std","size","makePredicate","filter","col1data","lhs","rhsFun","cmp","cmpType","col2data","rhs","resultSet","val1","val2","comparison","makeTable","outputCols","datasets","predicate","oc","table","empty","ds","clickAttOpen","attFileChosen","attendanceCount","_n","join","VAlert","VBtn","VCard","VCardText","VCardTitle","VListItem","VListItemContent","VList","VTextField","availableColumnToText","availableColumnToValue","currentCol","outputColumn","label","updateSourceColumn","VSelect","updateLhsCol","filterCol","ConditionOptions","updateResult","rhsValue","updateRhsCol","rhsCol","options","v1","v2","workbooks","currentFilter","VCardActions","VSwitch","sourceBook","clickOpenTarget","injectionResults","downloadResult","missing","downloadMissing","fileTargetChosen","useAttendance","targetFilename","sourceColumn","errors","warnings","warning","THRESHOLD","GradingPolicy","alternatives","missingValue","invalidResult","minGrade","maxGrade","roundingRule","num","floor","truncateRule","max","min","finalize","invalidAttendance","parseFloat","toFixed","checkError","Number","isNaN","message","checkWarning","SHEET_NAME","ID_CELL","ID_VAL","ID_COL_INDEX","RES_CELL","RES_VAL","RES_COL_INDEX","OUTPUT_KEY","resultPreflight","id","gradingPolicy","failedAtt","attendanceKeys","substring","checkAttendanceFailed","attendanceMap","convId","processResult","identityConfig","erna_dataset","exportColumns","std_dataset","entries","conv_key","res","checkSheetStructure","sheet","idcell","rescell","injectResults","wb","processed","id_ref","res_ref","removeRowsFromSheet","rows","rs","sort","skip","shift_ref","mutateResults","results","remove_rows","readResultEntries","student","rawTarget","entry","includeStudents","VExpansionPanel","VExpansionPanelContent","VExpansionPanelHeader","VExpansionPanels","targetData","date","mut","mutIdx","clickAddMutation","addMutationsChosen","updatedResults","mutations","oldValue","newValue","newMissing","oldMissing","VCardSubtitle","components","Combiner","Injector","Welcome","Mutator","methods","location","reload","VApp","VAppBar","VMain","VSpacer","VTab","VTabs","Vue","use","Vuetify","productionTip","vuetify","render","h","App","$mount"],"mappings":"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","file":"js/index.f49357c2.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"index\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/ese-grade-handler/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SelectColumn.vue?vue&type=style&index=0&id=5c14aff6&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-app-bar',{attrs:{\"app\":\"\",\"color\":\"primary\",\"dark\":\"\"}},[_c('div',{staticClass:\"d-flex align-center\"},[_c('h3',[_vm._v(\"ESE Grade Handler\")])]),_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"error\"},on:{\"click\":_vm.refresh}},[_vm._v(\"Reset\")])],1),_c('v-main',[_c('v-tabs',{attrs:{\"centered\":\"\"},model:{value:(_vm.currentTab),callback:function ($$v) {_vm.currentTab=$$v},expression:\"currentTab\"}},[_c('v-tab',[_vm._v(\"Welcome\")]),_c('v-tab',[_vm._v(\"Combiner\")]),_c('v-tab',[_vm._v(\"Injector\")]),_c('v-tab',[_vm._v(\"Mutator\")])],1),(_vm.currentTab == 0)?_c('Welcome'):(_vm.currentTab == 1)?_c('Combiner'):(_vm.currentTab == 2)?_c('Injector'):(_vm.currentTab == 3)?_c('Mutator'):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h2',[_vm._v(\"ESE Grade Handler\")]),_c('h3',[_vm._v(\"Introduction\")]),_c('p',[_vm._v(\"This is a tool that attempts to simplify a number of tasks that involve grades from students. Currently, there are two tasks it can help with: (1) combining student results from a number of different spreadsheet files or different sheets (tabs) within a file into a single table, and (2) injecting final course results into the official SPD spreadsheet format required to submit official grades. You can pick a tool you want to use at the top of the page, by clicking \\\"Combiner\\\" or \\\"Injector\\\". \")]),_c('h3',[_vm._v(\"How does it work\")]),_c('p',[_vm._v(\"For this tool to be able to use your spreadsheet files, they must have a certain structure. Sheets or Tabs that do not have this structure will be ignored.\")]),_c('ul',{staticStyle:{\"margin-bottom\":\"1em\"}},[_c('li',[_vm._v(\"A sheet with results must have a table that starts in cell \"),_c('code',[_vm._v(\"A1\")]),_vm._v(\" with a header in row \"),_c('code',[_vm._v(\"A\")]),_vm._v(\" (the first row) and data starting at row \"),_c('code',[_vm._v(\"B\")]),_vm._v(\" (the second row). Sheets with two header rows, for example as they are exported by Canvas, are not supported; you are advised to just delete additional header rows before you use a spreadsheet in this tool.\")]),_c('li',[_vm._v(\"At least one of the columns in a sheet must be a \"),_c('em',[_vm._v(\"key-column\")]),_vm._v(\" with student identities. A student identity is any piece of text that contains a single erna identity (e.g. \"),_c('code',[_vm._v(\"123456ab\")]),_vm._v(\") somewhere. \")]),_c('li',[_vm._v(\"A key column must hold a student identity in every row of the data, and every identity with a column must be unique: if the same student identity occurs twice within a key column, the column is not accepted as a key column. \")]),_c('li',[_vm._v(\"If there are multiple key columns, one of them is picked arbitrarily. If there are different key columns that have conflicting student identities, you may get unexpected results. It is thus advised to only have a single column with student identities. Currently, there is no check in place to warn you against these types of scenarios, although this may be added in the future. \")])]),_c('h3',[_vm._v(\"Attendance Data (new)\")]),_c('p',[_vm._v(\"Attendance data, exported verbatim from sin-online as \"),_c('code',[_vm._v(\"xls\")]),_vm._v(\" file, is now also supported. If you import attendance data, double entries are automatically merged (i.e. if students switched between session) and a 70% threshold is used to determine attendance. This threshold can be adjusted. Attendance data is supported both for the combiner, where you can add attendance columns to your output, and the injector, where it injects GGR when this is appropiate.\")]),_c('h3',[_vm._v(\"Is this safe?\")]),_c('p',[_vm._v(\"All processing of grades happens solely within your web-browser, and no data is transmitted over the internet by this tool. Once this website is loaded in your browser, you can disconnect from the internet to handle your grades offline. If you don't believe this, you can easily check this with the network activity inspector in your browser's developer tools, or by inspecting the \"),_c('a',{attrs:{\"href\":\"https://github.com/pcbouman-eur/ese-grade-handler\",\"target\":\"blank\"}},[_vm._v(\"source code of this application\")]),_vm._v(\".\")]),_c('h3',[_vm._v(\"I need feature X or feature Y is not working for me, can you do something about it?\")]),_c('p',[_vm._v(\"My main motivation to build this is for my own work as a teacher, and I do not have time to provide support. I built this in less than 10 hours, mostly to make my own life in handling grades easier. If you want to discuss something, you contact me, or even \"),_c('a',{attrs:{\"href\":\"https://github.com/pcbouman-eur/ese-grade-handler/issues\",\"target\":\"blank\"}},[_vm._v(\" raise an issue on Github\")]),_vm._v(\". However, I do not make any promises I can do something about it. I also do not have to give basic user support, and I hope the tool is mostly self-explanatory so that it is not needed.\")]),_c('p',[_vm._v(\"Some other schools have dedicated programmers whose main task is to build this kind of software that saves researchers and teachers valuable time. The fastest way to get the features you want might be to find a developer who can contribute the feature you need to this project, or who writes a separate tool. This an MIT-licensed open source tool, and useful contributions are welcome.\")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-container>\r\n    <v-row align='center' justify='center'>\r\n      <v-col cols=\"6\">\r\n        <h2>ESE Grade Handler</h2>\r\n        <h3>Introduction</h3>\r\n        <p>This is a tool that attempts to simplify a number of tasks that\r\n           involve grades from students. Currently, there are two tasks it can\r\n           help with: (1) combining student results from a number of different\r\n           spreadsheet files or different sheets (tabs) within a file into\r\n           a single table, and (2) injecting final course results into the\r\n           official SPD spreadsheet format required to submit official grades.\r\n           You can pick a tool you want to use at the top of the page, by\r\n           clicking \"Combiner\" or \"Injector\".\r\n        <h3>How does it work</h3>\r\n        <p>For this tool to be able to use your spreadsheet files, they must\r\n           have a certain structure. Sheets or Tabs that do not have this\r\n           structure will be ignored.</p>\r\n        <ul style=\"margin-bottom: 1em;\">\r\n          <li>A sheet with results must have a table that starts in cell\r\n            <code>A1</code> with a header in row <code>A</code> (the first\r\n            row) and data starting at row <code>B</code> (the second row).\r\n            Sheets with two header rows, for example as they are exported by\r\n            Canvas, are not supported; you are advised to just delete additional\r\n            header rows before you use a spreadsheet in this tool.</li>\r\n            <li>At least one of the columns in a sheet must be a <em>key-column</em>\r\n            with student identities. A student identity is any piece of text that\r\n            contains a single erna identity (e.g. <code>123456ab</code>) somewhere.\r\n            </li>\r\n            <li>A key column must hold a student identity in every row of the data,\r\n              and every identity with a column must be unique: if the same student\r\n              identity occurs twice within a key column, the column is not accepted\r\n              as a key column.\r\n            </li>\r\n            <li>If there are multiple key columns, one of them is picked arbitrarily.\r\n              If there are different key columns that have conflicting student identities,\r\n              you may get unexpected results. It is thus advised to only have a single\r\n              column with student identities. Currently, there is no check in place\r\n              to warn you against these types of scenarios, although this may be added\r\n              in the future.              \r\n            </li>\r\n        </ul>\r\n        <h3>Attendance Data (new)</h3>\r\n        <p>Attendance data, exported verbatim from sin-online as <code>xls</code>\r\n        file, is now also supported. If you import attendance data, double entries\r\n        are automatically merged (i.e. if students switched between session) and\r\n        a 70% threshold is used to determine attendance. This threshold can be\r\n        adjusted. Attendance data is supported both for the combiner, where you\r\n        can add attendance columns to your output, and the injector, where it\r\n        injects GGR when this is appropiate.</p>\r\n        <h3>Is this safe?</h3>\r\n        <p>All processing of grades happens solely within your web-browser,\r\n          and no data is transmitted over the internet by this tool. Once\r\n          this website is loaded in your browser, you can disconnect from the\r\n          internet to handle your grades offline. If you don't believe this, \r\n          you can easily check this with the network activity inspector in your\r\n          browser's developer tools, or by inspecting the <a href=\"https://github.com/pcbouman-eur/ese-grade-handler\"\r\n          target=\"blank\">source code of this application</a>.</p>\r\n        <h3>I need feature X or feature Y is not working for me, can you do something about it?</h3>\r\n        <p>My main motivation to build this is for my own work as a teacher, and\r\n          I do not have time to provide support. I built this in\r\n          less than 10 hours, mostly to make my own life in handling grades\r\n          easier. If you want to discuss something, you contact me, or even\r\n          <a href=\"https://github.com/pcbouman-eur/ese-grade-handler/issues\"\r\n          target=\"blank\">\r\n          raise an issue on Github</a>. However, I do not make any promises I can do\r\n          something about it. I also do not have to give basic user support,\r\n          and I hope the tool is mostly self-explanatory so that it is not needed.</p>\r\n        <p>Some other schools have dedicated programmers whose main task is\r\n           to build this kind of software that saves researchers and teachers\r\n           valuable time. The fastest way to get the features you want might be\r\n           to find a developer who can contribute the feature you need to this\r\n           project, or who writes a separate tool. This an MIT-licensed\r\n           open source tool, and useful contributions are welcome.</p>\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    name: 'Welcome'\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\nh3 {\r\n  margin-top: 1em;\r\n}\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Welcome.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Welcome.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Welcome.vue?vue&type=template&id=40722623&scoped=true&\"\nimport script from \"./Welcome.vue?vue&type=script&lang=js&\"\nexport * from \"./Welcome.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Welcome.vue?vue&type=style&index=0&id=40722623&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"40722623\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCol,VContainer,VRow})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h2',[_vm._v(\"Combine Results\")]),_c('p',[_vm._v(\"Combine student results from different input datasets into a single output dataset. You can toggle whether the students from a dataset should be added to the output. If you have a file with results from last year, you can disable adding students from last year to the set of output students. In that case, the results from last year's students are only included if their identities also appear in a dataset from this year (where the toggle is active). \")])])],1),_c('v-row',[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h4',[_vm._v(\"Input Spreadsheets\")]),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickOpen}},[_vm._v(\"Add Spreadsheet\")]),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickOpenCanvas}},[_vm._v(\"Add Canvas Grades\")]),_c('input',{ref:\"openFileInput\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xlsx,.csv\"},on:{\"change\":_vm.fileChosen}}),_c('input',{ref:\"openCanvasInput\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".csv\"},on:{\"change\":_vm.canvasFileChosen}}),_c('br'),_vm._l((_vm.workbooks),function(book){return _c('div',{key:book.filename},[_c('h3',[_vm._v(_vm._s(book.filename))]),_vm._l((book.frames),function(frame){return _c('v-card',{key:frame.sheetName},[_c('v-card-title',[_vm._v(_vm._s(frame.sheetName))]),_c('v-card-actions',[_c('v-switch',{attrs:{\"label\":\"Add all students to output\"},model:{value:(frame.includeStudents),callback:function ($$v) {_vm.$set(frame, \"includeStudents\", $$v)},expression:\"frame.includeStudents\"}})],1)],1)}),(book.skipped.length > 0)?_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" \"+_vm._s(book.skipped.length)+\" sheets were skipped \")]):_vm._e()],2)}),_c('AttendancePanel',{model:{value:(_vm.attendance),callback:function ($$v) {_vm.attendance=$$v},expression:\"attendance\"}})],2),_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h4',[_vm._v(\"Output Spreadsheet\")]),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":_vm.availableKeys.length == 0},on:{\"click\":_vm.addOutputCol}},[_vm._v(\"Add Output Column\")]),_vm._v(\" \"),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":_vm.cantExport},on:{\"click\":_vm.exportSheet}},[_vm._v(\"Export Spreadsheet\")]),_c('br'),_c('v-switch',{attrs:{\"label\":\"Remove students without any results\"},model:{value:(_vm.dropEmptyStudents),callback:function ($$v) {_vm.dropEmptyStudents=$$v},expression:\"dropEmptyStudents\"}}),(this.availableKeys.length > 0)?_c('div',[_c('h4',[_vm._v(\"Key Column\")]),_c('v-select',{attrs:{\"items\":_vm.availableKeys,\"label\":\"Key type\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(_vm.keyColumn),callback:function ($$v) {_vm.keyColumn=$$v},expression:\"keyColumn\"}})],1):_vm._e(),_vm._l((_vm.outputColumns),function(col,idx){return _c('div',{key:'output-'+idx},[_c('h4',[_vm._v(\"Output Column \"+_vm._s(idx+1))]),_c('v-container',{staticClass:\"dense\"},[_c('v-row',[_c('v-col',{staticClass:\"dense\",attrs:{\"cols\":\"6\"}},[_c('SelectColumn',{attrs:{\"label\":\"Source Column\",\"availableColumns\":_vm.availableColumns,\"availableKeys\":_vm.availableKeys},model:{value:(_vm.outputColumns[idx]),callback:function ($$v) {_vm.$set(_vm.outputColumns, idx, $$v)},expression:\"outputColumns[idx]\"}})],1),_c('v-col',{staticClass:\"dense\",attrs:{\"cols\":\"6\"}},[_c('v-text-field',{attrs:{\"label\":\"Output Column Name\",\"outlined\":\"\",\"dense\":\"\"},model:{value:(col.outputName),callback:function ($$v) {_vm.$set(col, \"outputName\", $$v)},expression:\"col.outputName\"}})],1)],1)],1)],1)}),(this.availableColumns.length > 0)?_c('div',[_c('h4',[_vm._v(\"Filter Students\")]),_c('v-switch',{attrs:{\"label\":_vm.filterLabel},model:{value:(_vm.addFilter),callback:function ($$v) {_vm.addFilter=$$v},expression:\"addFilter\"}}),_c('ConditionPanel',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.addFilter),expression:\"addFilter\"}],attrs:{\"availableColumns\":_vm.availableColumns,\"availableKeys\":_vm.availableKeys},on:{\"input\":_vm.updateFilter}})],1):_vm._e()],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import XLSX from 'xlsx';\r\nimport {DataFrame} from 'danfojs/dist/core/frame';\r\n\r\nfunction sheetToDataframe(worksheet, header_index=1, data_index=2) {\r\n    const range = XLSX.utils.decode_range(worksheet['!ref']);\r\n    const column_names = [], data = [], column_indices = [];\r\n    for (let R = header_index - 1; R <= range.e.r; ++R) {\r\n        if (R == header_index - 1) {\r\n            for (let C = range.s.c; C <= range.e.c; ++C) {\r\n                //Populate column_names\r\n                const cell_ref = XLSX.utils.encode_cell({ c: C, r: header_index - 1 });\r\n                    if (worksheet[cell_ref]) {\r\n                    const header = worksheet[cell_ref].v;\r\n                    if (header) {\r\n                        column_names.push(header.toString().trim());\r\n                        column_indices.push(C);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else if (R >= data_index - 1) {\r\n            //Populate corresponding data row\r\n            const row_data = [];\r\n            let add = false;\r\n            for (var C of column_indices) {\r\n                const cell_ref = XLSX.utils.encode_cell({ c: C, r: R });\r\n                if (worksheet[cell_ref]) {\r\n                    const val = worksheet[cell_ref].v;\r\n                    row_data.push(val);\r\n                    if (val) {\r\n                        add = true;\r\n                    }                    \r\n                }\r\n                else {\r\n                    row_data.push(null);\r\n                }\r\n            }\r\n            if (add) {\r\n                data.push(row_data);\r\n            }\r\n\r\n        }\r\n    }\r\n    let df = new DataFrame(data, { columns: column_names });\r\n    return df;\r\n}\r\n\r\nexport default sheetToDataframe;","const IdentityConfig = {\r\n    keyTypes: [\r\n            { name: 'erna', pattern: /\\d{6}[a-z]{2}/g},\r\n            { name: 'student number', pattern: /\\d{6}/g}\r\n    ],\r\n    conversions: [\r\n        {to: 'student number', from: ['erna']}\r\n    ],\r\n    convert(fromType, toType, val) {\r\n        // You'd probably want a fourth argument with some current database?\r\n        if (fromType == toType) {\r\n            return val;\r\n        }\r\n        if (fromType == 'erna' && toType == 'student number') {\r\n            return val.substr(0,6);\r\n        }\r\n        throw 'Conversion from '+fromType+' to '+toType+' not supported';\r\n    },\r\n    preferredType(types) {\r\n        for (let kt of this.keyTypes) {\r\n            if (types.includes(kt.name)) {\r\n                return kt.name;\r\n            }\r\n        }\r\n        throw 'No preferred type is available';\r\n    },\r\n    getPattern(name) {\r\n        for (let obj of this.keyTypes) {\r\n            if (obj.name == name) {\r\n                return obj.pattern;\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nexport default IdentityConfig;","import sheetToDataframe from './sheetToDataframe';\r\nimport IdentityConfig from './IdentityConfig';\r\n\r\nfunction checkKeySpec(column, spec) {\r\n    const keySet = new Set();\r\n    const keyCol = [];\r\n    for (let el of column.data) {\r\n        const value = String(el);\r\n        const matches = Array.from(value.matchAll(spec.pattern));\r\n        if (matches.length != 1) {\r\n            return {result: false, error: 'No match for value \"'+value+'\"'};\r\n        }\r\n        const key = matches[0][0];\r\n        if (keySet.has(key)) {\r\n            return {result: false, error: 'Multiple occurences of \"'+value+'\"'};\r\n        }\r\n        keySet.add(key);\r\n        keyCol.push(key);\r\n    }\r\n    return {result: true, keyCol};\r\n}\r\n\r\nfunction findKeyColumns(df, config=IdentityConfig) {\r\n    const result = {};\r\n    cols:\r\n    for (let colname of df.columns) {\r\n        for (let keySpec of config.keyTypes) {\r\n            const spec = checkKeySpec(df[colname], keySpec);\r\n            if (spec.result && !(spec.name in result)) {\r\n                result[keySpec.name] = {type: keySpec.name, column: colname, keys: spec.keyCol};\r\n                continue cols;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction processWorkbook(workbook) {\r\n    const frames = [], skipped = [];\r\n    for (let sheetName of workbook.SheetNames) {\r\n        let error = 'No suitable key column found';\r\n        try {\r\n            const df = sheetToDataframe(workbook.Sheets[sheetName]);\r\n            const keys = findKeyColumns(df);\r\n            if (Object.keys(keys).length > 0) {\r\n                frames.push({sheetName, df, keys});\r\n                error = undefined;\r\n            }\r\n        }\r\n        catch (err) {\r\n            error = 'Sheet has invalid structure';\r\n            console.log(err);\r\n        }\r\n        if (error) {\r\n            skipped.push({sheetName, error});\r\n            console.log({sheetName, error});\r\n        }\r\n    }\r\n    return {frames, skipped};\r\n}\r\n\r\nconst CANVAS_SIS_COL = 'SIS User ID';\r\n\r\nfunction processCanvasWorkbook(workbook) {\r\n    const frames = [], skipped = [];\r\n    if (workbook.SheetNames && workbook.SheetNames.length == 1) {\r\n        let error = 'No suitable key column found';\r\n        try {\r\n            const df = sheetToDataframe(workbook.Sheets[workbook.SheetNames[0]], 1, 3);\r\n            // Kind of weird way to get rid of NaN users (like Test Students)\r\n            df.query({column: CANVAS_SIS_COL, is: '>', to: '', inplace: true});\r\n            const keys = findKeyColumns(df);\r\n            if (Object.keys(keys).length > 0) {\r\n                frames.push({sheetName: 'Canvas Grades', df, keys});\r\n                error = undefined;\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.log(err);\r\n            error = 'Sheet has invalid structure';\r\n        }\r\n        if (error) {\r\n            skipped.push({sheetName: 'Canvas Grades', error});\r\n        }\r\n    }\r\n    else {\r\n        skipped.push({sheetName: 'All', error: 'Unexpected structure in sheet'});\r\n    }\r\n    return {frames, skipped};\r\n}\r\n\r\nconst USER_PATTERN = /(user|student|erna)/i;\r\nconst USER_PATTERN_HELP = \"a column named either 'user', 'student' or 'erna'\"\r\nconst SHEET_KEY = 'Attendance';\r\nconst EXEMPTION_PATTERN = /(vrijstelling|exemption)/i;\r\nconst EXEMPTION_PATTERN_HELP = \"a column named 'vrijstelling' or 'exemption'\";\r\nconst SESSION_PATTERN = /(s|sessie|session)[_ ]*(\\d+)/i;\r\nconst FIRST_ROW = 6;\r\nconst DEFAULT_MINIMUM_PERCENTAGE = 0.7;\r\n\r\nfunction findColumnByPattern(df, pat) {\r\n    for (const col of df.columns.values()) {\r\n        if (col.match(pat)) {\r\n            return col;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction processAttendanceWorkbook(workbook) {\r\n    const attSheet = workbook.Sheets[SHEET_KEY];\r\n    if (!attSheet) {\r\n        return {error: 'No sheet found with key '+SHEET_KEY};\r\n    }\r\n    const df = sheetToDataframe(attSheet,FIRST_ROW,FIRST_ROW+1);\r\n\r\n    const USER_KEY = findColumnByPattern(df, USER_PATTERN);\r\n    const EXEMPTION_KEY = findColumnByPattern(df, EXEMPTION_PATTERN);\r\n    \r\n    if (!USER_KEY) {\r\n        return {error: 'No user column found. Expected '+USER_PATTERN_HELP};\r\n    }\r\n    if (!EXEMPTION_KEY) {\r\n        return {error: 'No exemption column found. Expected '+EXEMPTION_PATTERN_HELP};\r\n    }\r\n\r\n    const userCol = df[USER_KEY].data;\r\n    const exemptionCol = df[EXEMPTION_KEY].data;\r\n\r\n    let sessionKeys = [];\r\n    let sessionCols = {};\r\n    for (let col of df.columns) {\r\n        if (col.match(SESSION_PATTERN)) {\r\n            sessionKeys.push(col);\r\n            sessionCols[col] = df[col].data;\r\n        }\r\n    }\r\n\r\n    const data = {};\r\n\r\n    const duplicates = [];\r\n\r\n    for (let row of df.index) {\r\n        const userName = userCol[row];\r\n        let exemption = exemptionCol[row];\r\n        const sessionsPresent = new Set();\r\n        for (let ses of sessionKeys) {\r\n            const present = sessionCols[ses][row];\r\n            if (present) {\r\n                sessionsPresent.add(ses);\r\n            }\r\n        }\r\n        if (data[userName]) {\r\n            duplicates.push(userName);\r\n            const oldrec = data[userName];\r\n            exemption = exemption || oldrec.exemption;\r\n            for (let ses of oldrec.sessionsPresent) {\r\n                sessionsPresent.add(ses);\r\n            }\r\n        }\r\n        data[userName] = {userName, exemption, sessionsPresent};\r\n        \r\n        // TODO: This is kind of sloppy, and assumes ERNA's and student numbers do not coincide\r\n        const stdNum = IdentityConfig.convert('erna', 'student number', userName);\r\n        data[stdNum] = data[userName];\r\n    }\r\n\r\n    const threshold = Math.ceil(DEFAULT_MINIMUM_PERCENTAGE * sessionKeys.length);\r\n    return {sessions: sessionKeys, data, duplicates, threshold};\r\n}\r\n\r\nexport {processWorkbook, processCanvasWorkbook, processAttendanceWorkbook};\r\n","import IdentityConfig from \"./IdentityConfig\";\r\n\r\nfunction extractKeys(keys, outputKey) {\r\n    if (keys[outputKey]) {\r\n        return keys[outputKey].keys;\r\n    }\r\n    for (const conv_spec of IdentityConfig.conversions) {\r\n        if (conv_spec.to == outputKey) {\r\n            for (const src_key of conv_spec.from) {\r\n                if (keys[src_key]) {\r\n                    return keys[src_key].keys.map(v => IdentityConfig.convert(src_key, outputKey, v));\r\n                }\r\n            }\r\n        }\r\n    }\r\n    throw 'Unable to convert data from this from to \"'+outputKey+'\"';\r\n}\r\n\r\nfunction columnToDataset(col, outputKey, allKeys) {\r\n    console.log(col);\r\n    if (col.type == 'df') {\r\n        const col_keys = extractKeys(col.frame.keys, outputKey);\r\n        const col_data = col.frame.df[col.column].data;\r\n        const pairs = {};\r\n        col_keys.forEach((key, idx) => {\r\n            pairs[key] = col_data[idx];\r\n        });\r\n        return pairs;\r\n    }\r\n    if (col.type == 'attendance-cat') {\r\n        const result = {};\r\n        const th = col.data.threshold;\r\n        for (let std of allKeys) {\r\n            const el = col.data.data[std];\r\n            result[std] = 'NO DATA';\r\n            if (el) {\r\n                if (el.exemption) {\r\n                    result[std] = 'EXEMPTION';\r\n                }\r\n                else if (el.sessionsPresent.size >= th) {\r\n                    result[std] = 'PASS';\r\n                }\r\n                else {\r\n                    result[std] = 'FAIL';\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    if (col.type == 'attendance-bool') {\r\n        const result = {};\r\n        const th = col.data.threshold;\r\n        for (let std of allKeys) {\r\n            result[std] = 0;\r\n            const el = col.data.data[std];\r\n            if (el) {\r\n                if (el.exemption || el.sessionsPresent.size >= th) {\r\n                    result[std] = 1;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    if (col.type == 'attendance-count') {\r\n        const result = {};\r\n        for (let std of allKeys) {\r\n            const el = col.data.data[std];\r\n            if (el && el.sessionsPresent) {\r\n                result[std] = el.sessionsPresent.size;\r\n            }\r\n        }\r\n        return result;\r\n    }    \r\n    return {};\r\n}\r\n\r\nfunction makePredicate(outputKey, allKeys, filter) {\r\n    if (!filter) {\r\n        return () => true;\r\n    }\r\n    const col1data = columnToDataset(filter.lhs.data, outputKey, allKeys);\r\n    let rhsFun = () => null;\r\n    if (filter.cmp.cmpType == 'column') {\r\n        const col2data = columnToDataset(filter.rhs.data, outputKey, allKeys);\r\n        rhsFun = (key) => col2data[key];\r\n    }\r\n    if (filter.cmp.cmpType == 'value') {\r\n        rhsFun = () => filter.rhs;\r\n    }\r\n    const resultSet = new Set();\r\n    for (const key of allKeys) {\r\n        const val1 = col1data[key];\r\n        const val2 = rhsFun(key);\r\n        if (filter.cmp.comparison(val1, val2)) {\r\n            resultSet.add(key);\r\n        }\r\n    }\r\n    return (key) => resultSet.has(key);\r\n}\r\n\r\nfunction makeTable(outputKey, allKeys, outputCols, dropEmptyStudents, filter) {\r\n    const datasets = outputCols.map(col => columnToDataset(col.data, outputKey, allKeys));\r\n\r\n    const predicate = makePredicate(outputKey, allKeys, filter);\r\n\r\n    const header = [outputKey];\r\n    for (const oc of outputCols) {\r\n        header.push(oc.name);\r\n    }\r\n\r\n    const table = [header];\r\n\r\n    // TODO: data\r\n    console.log(allKeys);\r\n    for (const key of allKeys) {\r\n        if (!predicate(key)) {\r\n            continue;\r\n        }\r\n        const row = [key];\r\n        let empty = true;\r\n        for (const ds of datasets) {\r\n            const val = ds[key];\r\n            console.log(ds, key, val);\r\n            if (val || val === 0 || val === false) {\r\n                row.push(val);\r\n                empty=false;\r\n            }\r\n            else {\r\n                row.push(null);\r\n            }\r\n        }\r\n        if (!empty || !dropEmptyStudents) {\r\n            table.push(row);\r\n        }\r\n    }\r\n    \r\n    return table;\r\n}\r\n\r\nexport default {makeTable, columnToDataset};\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"margin-top\":\"1em\"}},[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickAttOpen}},[_vm._v(\"Select Attendance Spreadsheet\")]),_c('input',{ref:\"openAttFileInput\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xls,.xlsx\"},on:{\"change\":_vm.attFileChosen}}),_c('br'),(_vm.value)?_c('v-card',[_c('v-card-title',[_vm._v(\"Attendance data\")]),_c('v-card-text',[_c('h5',[_vm._v(\"Attendance data loaded for \"+_vm._s(_vm.attendanceCount)+\" students. \"+_vm._s(_vm.value.sessions.length)+\" sessions were found. \")]),_c('v-list-item',[_c('v-list-item-content',[_c('v-text-field',{attrs:{\"type\":\"number\",\"min\":\"0\",\"max\":_vm.value.sessions.length,\"label\":\"Minimum attendance threshold\"},model:{value:(_vm.value.threshold),callback:function ($$v) {_vm.$set(_vm.value, \"threshold\", _vm._n($$v))},expression:\"value.threshold\"}})],1)],1),(_vm.value.duplicates.length > 0)?_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" Multiple entries were found for the following students whose data was merged: \"+_vm._s(_vm.value.duplicates.join(', '))+\" \")]):_vm._e()],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div style=\"margin-top: 1em\">\r\n    <v-btn color=\"primary\" @click=\"clickAttOpen\">Select Attendance Spreadsheet</v-btn>\r\n    <input type=\"file\" style=\"display: none\" ref=\"openAttFileInput\"\r\n            accept=\".xls,.xlsx\" @change=\"attFileChosen\" />\r\n    <br />\r\n    <v-card v-if=\"value\">\r\n      <v-card-title>Attendance data</v-card-title>\r\n      <v-card-text>\r\n        <h5>Attendance data loaded for {{attendanceCount}} students.\r\n            {{value.sessions.length}} sessions were found.\r\n        </h5>\r\n        <v-list-item>\r\n          <v-list-item-content>\r\n            <v-text-field type=\"number\" v-model.number=\"value.threshold\"\r\n              min=\"0\" :max=\"value.sessions.length\" label=\"Minimum attendance threshold\" />\r\n          </v-list-item-content>\r\n        </v-list-item>\r\n        <v-alert v-if=\"value.duplicates.length > 0\" type=\"warning\">\r\n          Multiple entries were found for the following students whose data\r\n          was merged: {{value.duplicates.join(', ')}}\r\n        </v-alert>\r\n      </v-card-text>\r\n    </v-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import XLSX from 'xlsx';\r\n  import {processAttendanceWorkbook} from '../util/processWorkbook';\r\n\r\n  export default {\r\n    name: 'AttendancePanel',\r\n    props: ['value'],\r\n    methods: {\r\n      clickAttOpen() {\r\n        this.$refs.openAttFileInput.click();\r\n      },      \r\n      attFileChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            const data = new Uint8Array(ev2.target.result);\r\n            const workbook = XLSX.read(data, {type: 'array'});\r\n            const att = processAttendanceWorkbook(workbook);\r\n            this.$emit('input',att);\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },\r\n    },\r\n    computed: {\r\n      attendanceCount() {\r\n        if (this.value && this.value.data) {\r\n          return Object.keys(this.value.data).length;\r\n        }\r\n        return 0;\r\n      }\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.margin-top {\r\n  margin-top: 1em;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttendancePanel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttendancePanel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AttendancePanel.vue?vue&type=template&id=54ae2d44&scoped=true&\"\nimport script from \"./AttendancePanel.vue?vue&type=script&lang=js&\"\nexport * from \"./AttendancePanel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AttendancePanel.vue?vue&type=style&index=0&id=54ae2d44&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"54ae2d44\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardText,VCardTitle,VListItem,VListItemContent,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.value)?_c('v-select',{attrs:{\"items\":_vm.availableColumns,\"item-text\":_vm.availableColumnToText,\"item-value\":_vm.availableColumnToValue,\"value\":_vm.currentCol.outputColumn,\"label\":_vm.label,\"outlined\":\"\",\"dense\":\"\"},on:{\"change\":function (v) { return _vm.updateSourceColumn(v, _vm.currentCol); }}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-select\r\n    v-if=\"value\"\r\n    :items=\"availableColumns\"\r\n    :item-text=\"availableColumnToText\"\r\n    :item-value=\"availableColumnToValue\"\r\n    :value=\"currentCol.outputColumn\"\r\n    @change=\"v => updateSourceColumn(v, currentCol)\"\r\n    :label=\"label\"\r\n    outlined\r\n    dense />\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    name: 'SelectColumn',\r\n    props: ['availableColumns', 'availableKeys', 'value', 'label', 'index'],\r\n    methods: {\r\n      availableColumnToText(c) {\r\n        //console.log(c);\r\n        if (c.type == 'attendance-cat') {\r\n          return 'Attendance Status';\r\n        }\r\n        if (c.type == 'attendance-bool') {\r\n          return 'Attendance Passed';\r\n        }\r\n        if (c.type == 'attendance-count') {\r\n          return 'Attendance Count';\r\n        }        \r\n        if (c.type == 'df') {\r\n          if (c.wb && c.wb.filename) {\r\n            return c.wb.filename + ' / ' + c.frame.sheetName + ' / ' + c.column;\r\n          }\r\n          else if (c.frame && c.frame.sheetName && c.column) {\r\n            return 'Unknown Workbook / ' + c.frame.sheetName + ' / ' + c.column;\r\n          }\r\n          else if (c.column) {\r\n            return 'Unknown Workbook / Unknown Sheet / ' + c.column;\r\n          }\r\n          return '[ERROR - Unknown Column]';\r\n        }\r\n        return '[ERROR - Unknown Column Type]';\r\n      },\r\n      availableColumnToValue(c) {\r\n        return {index: c.index, column: c.column};\r\n      },\r\n      updateSourceColumn(newVal, col) {\r\n        col.outputColumn = newVal;\r\n        col.outputName = newVal.column;\r\n        this.$emit('input', col);\r\n      },\r\n    },\r\n    computed: {\r\n      currentCol() {\r\n        return this.value;\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.dense {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SelectColumn.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SelectColumn.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SelectColumn.vue?vue&type=template&id=5c14aff6&scoped=true&\"\nimport script from \"./SelectColumn.vue?vue&type=script&lang=js&\"\nexport * from \"./SelectColumn.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SelectColumn.vue?vue&type=style&index=0&id=5c14aff6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5c14aff6\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VSelect } from 'vuetify/lib/components/VSelect';\ninstallComponents(component, {VSelect})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',[_c('v-card-text',[(_vm.availableColumns.length > 0)?_c('v-container',{attrs:{\"dense\":\"\"}},[_c('v-row',{attrs:{\"dense\":\"\"}},[_c('v-col',{staticClass:\"extra-dense\",attrs:{\"cols\":\"12\"}},[_c('SelectColumn',{attrs:{\"label\":\"Column\",\"availableColumns\":_vm.availableColumns,\"availableKeys\":_vm.availableKeys},on:{\"input\":_vm.updateLhsCol},model:{value:(_vm.filterCol),callback:function ($$v) {_vm.filterCol=$$v},expression:\"filterCol\"}})],1)],1),_c('v-row',{attrs:{\"dense\":\"\"}},[_c('v-col',{staticClass:\"extra-dense\",attrs:{\"cols\":\"4\"}},[_c('v-select',{attrs:{\"items\":_vm.ConditionOptions,\"item-text\":function (c) { return c.label + ' (' + c.cmpType +')'; },\"item-value\":function (c) { return c; },\"label\":\"Comparison Type\",\"outlined\":\"\",\"dense\":\"\"},on:{\"change\":_vm.updateResult},model:{value:(_vm.cmpType),callback:function ($$v) {_vm.cmpType=$$v},expression:\"cmpType\"}})],1),_c('v-col',{staticClass:\"extra-dense\",attrs:{\"cols\":\"8\"}},[(_vm.showRhsValue)?_c('v-text-field',{attrs:{\"label\":\"Value\",\"outlined\":\"\",\"dense\":\"\"},on:{\"input\":_vm.updateResult},model:{value:(_vm.rhsValue),callback:function ($$v) {_vm.rhsValue=$$v},expression:\"rhsValue\"}}):_vm._e(),(_vm.showRhsColumn)?_c('SelectColumn',{attrs:{\"label\":\"Column\",\"availableColumns\":_vm.availableColumns,\"availableKeys\":_vm.availableKeys},on:{\"input\":_vm.updateRhsCol},model:{value:(_vm.rhsCol),callback:function ($$v) {_vm.rhsCol=$$v},expression:\"rhsCol\"}}):_vm._e()],1)],1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// TODO: tolerance options for numeric comparison?\r\n\r\nconst options = [\r\n    {\r\n        label: '<',\r\n        cmpType: 'column',\r\n        comparison: (v1, v2) => v1 < v2\r\n    },\r\n    {\r\n        label: '≤',\r\n        cmpType: 'column',\r\n        comparison: (v1, v2) => v1 <= v2\r\n    },\r\n    {\r\n        label: '=',\r\n        cmpType: 'column',\r\n        comparison: (v1, v2) => v1 == v2\r\n    },\r\n    {\r\n        label: '≠',\r\n        cmpType: 'column',\r\n        comparison: (v1, v2) => v1 != v2\r\n    },\r\n    {\r\n        label: '≥',\r\n        cmpType: 'column',\r\n        comparison: (v1, v2) => v1 >= v2\r\n    },\r\n    {\r\n        label: '>',\r\n        cmpType: 'column',\r\n        comparison: (v1, v2) => v1 > v2\r\n    },\r\n    {\r\n        label: '<',\r\n        cmpType: 'value',\r\n        comparison: (v1, v2) => v1 < v2\r\n    },\r\n    {\r\n        label: '≤',\r\n        cmpType: 'value',\r\n        comparison: (v1, v2) => v1 <= v2\r\n    },\r\n    {\r\n        label: '=',\r\n        cmpType: 'value',\r\n        comparison: (v1, v2) => v1 == v2\r\n    },\r\n    {\r\n        label: '≠',\r\n        cmpType: 'value',\r\n        comparison: (v1, v2) => v1 != v2\r\n    },\r\n    {\r\n        label: '≥',\r\n        cmpType: 'value',\r\n        comparison: (v1, v2) => v1 >= v2\r\n    },\r\n    {\r\n        label: '>',\r\n        cmpType: 'value',\r\n        comparison: (v1, v2) => v1 > v2\r\n    },\r\n    {\r\n        label: 'is a truthy value',\r\n        cmpType: 'unary',\r\n        comparison: (v) => v\r\n    },\r\n    {\r\n        label: 'is a falsy value',\r\n        cmpType: 'unary',\r\n        comparison: (v) => !v\r\n    }\r\n];\r\n\r\nexport default options;","<template>\r\n  <v-card>\r\n  <v-card-text>\r\n    <v-container v-if=\"availableColumns.length > 0\" dense>\r\n      <v-row dense>\r\n        <v-col cols=\"12\" class=\"extra-dense\">\r\n          <SelectColumn v-model=\"filterCol\"\r\n            label=\"Column\" :availableColumns=\"availableColumns\" :availableKeys=\"availableKeys\"\r\n            @input=\"updateLhsCol\" />\r\n        </v-col>\r\n      </v-row>\r\n      <v-row dense>\r\n        <v-col cols=\"4\" class=\"extra-dense\">\r\n          <v-select :items=\"ConditionOptions\"\r\n                    :item-text=\"c => c.label + ' (' + c.cmpType +')'\"\r\n                    :item-value=\"c => c\"\r\n                    v-model=\"cmpType\"\r\n                    @change=\"updateResult\"\r\n                    label=\"Comparison Type\"\r\n                    outlined\r\n                    dense />\r\n        </v-col>\r\n        <v-col cols=\"8\" class=\"extra-dense\">\r\n          <v-text-field v-if=\"showRhsValue\" v-model=\"rhsValue\" @input=\"updateResult\" label=\"Value\" outlined dense />\r\n          <SelectColumn v-if=\"showRhsColumn\" v-model=\"rhsCol\"\r\n            label=\"Column\" :availableColumns=\"availableColumns\" :availableKeys=\"availableKeys\"\r\n            @input=\"updateRhsCol\"/>\r\n        </v-col>\r\n      </v-row>\r\n    </v-container>\r\n  </v-card-text>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\n  import SelectColumn from './SelectColumn';\r\n  import ConditionOptions from '../util/ConditionOptions';\r\n  \r\n  export default {\r\n    name: 'ConditionPanel',\r\n    components: {\r\n      SelectColumn\r\n    },\r\n    props: ['availableColumns', 'availableKeys'],\r\n    data: () => ({\r\n      filterCol: null,\r\n      rhsCol: null,\r\n      rhsValue: '',\r\n      ConditionOptions,\r\n      cmpType: ConditionOptions[0]\r\n    }),\r\n    created() {\r\n      this.init();\r\n    },\r\n    methods: {\r\n      updateLhsCol(col) {\r\n        this.filterColIdx = col.index;\r\n        this.updateResult();\r\n      },\r\n      updateRhsCol(col) {\r\n        this.rhsColIdx = col.index;\r\n        this.updateResult();\r\n      },\r\n      updateResult() {\r\n        if (this.filterCol) {\r\n          const lhsCol = this.availableColumns[this.filterCol.outputColumn.index];\r\n          const result = {lhs: {name: lhsCol.outputName, data: lhsCol},\r\n                          cmp: this.cmpType};\r\n          if (this.showRhsValue) {\r\n            result.rhs = this.rhsValue;\r\n          }\r\n          if (this.showRhsColumn) {\r\n            const rhsCol = this.availableColumns[this.rhsCol.outputColumn.index];\r\n            result.rhs = {name: rhsCol.outputName, data: rhsCol};\r\n          }\r\n          this.$emit('input', result);\r\n        }\r\n      },\r\n      init() {\r\n        if (!this.filterCol) {\r\n          this.filterCol = {\r\n             outputKey: this.availableKeys[0],\r\n             outputColumn: this.availableColumns[0],\r\n             outputName: this.availableColumns[0].column\r\n          };\r\n          this.rhsCol = {\r\n             outputKey: this.availableKeys[0],\r\n             outputColumn: this.availableColumns[0],\r\n             outputName: this.availableColumns[0].column\r\n          };\r\n          this.updateResult();\r\n        }\r\n      }\r\n    },\r\n    computed: {\r\n      showRhsValue() {\r\n        return this.cmpType.cmpType == 'value';\r\n      },\r\n      showRhsColumn() {\r\n        return this.cmpType.cmpType == 'column';\r\n      },\r\n    },\r\n    watch: {\r\n      availableColumns() {\r\n        this.init();\r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.extra-dense {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConditionPanel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConditionPanel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ConditionPanel.vue?vue&type=template&id=ff8925b2&scoped=true&\"\nimport script from \"./ConditionPanel.vue?vue&type=script&lang=js&\"\nexport * from \"./ConditionPanel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ConditionPanel.vue?vue&type=style&index=0&id=ff8925b2&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ff8925b2\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VCard,VCardText,VCol,VContainer,VRow,VSelect,VTextField})\n","<template>\r\n  <v-container>\r\n    <v-row align=\"center\" justify=\"center\">\r\n      <v-col cols=\"6\">\r\n        <h2>Combine Results</h2>\r\n        <p>Combine student results from different input datasets into a single output dataset.\r\n           You can toggle whether the students from a dataset should be added to the output.\r\n           If you have a file with results from last year, you can disable adding students from\r\n           last year to the set of output students. In that case, the results from last year's\r\n           students  are only included if their identities also appear in a dataset from this\r\n           year (where the toggle is active).\r\n        </p>\r\n      </v-col>\r\n    </v-row>\r\n    <v-row>\r\n      <v-col cols=\"6\">\r\n        <h4>Input Spreadsheets</h4>\r\n        <v-btn color=\"primary\" @click=\"clickOpen\">Add Spreadsheet</v-btn>\r\n        <v-btn color=\"primary\" @click=\"clickOpenCanvas\">Add Canvas Grades</v-btn>\r\n        <input type=\"file\" style=\"display: none\" ref=\"openFileInput\"\r\n                accept=\".xlsx,.csv\" @change=\"fileChosen\" />\r\n        <input type=\"file\" style=\"display: none\" ref=\"openCanvasInput\"\r\n                accept=\".csv\" @change=\"canvasFileChosen\" />                \r\n        <br />\r\n        <div v-for=\"book in workbooks\" :key=\"book.filename\">\r\n          <h3>{{book.filename}}</h3>\r\n          <v-card v-for=\"frame in book.frames\" :key=\"frame.sheetName\">\r\n            <v-card-title>{{frame.sheetName}}</v-card-title>\r\n            <!-- <v-card-text v-if=\"frame.keys.length == 1\">\r\n              Key column: {{frame.keys[0].column}} ({{frame.keys[0].type}})\r\n            </v-card-text>\r\n            <v-card-text v-else>\r\n              Multiple columns with identities found, this is currently not supported.\r\n            </v-card-text> -->\r\n            <v-card-actions>\r\n              <v-switch label=\"Add all students to output\" v-model=\"frame.includeStudents\" />\r\n            </v-card-actions>\r\n          </v-card>\r\n          <v-alert v-if=\"book.skipped.length > 0\" type=\"warning\">\r\n            {{book.skipped.length}} sheets were skipped\r\n          </v-alert>\r\n        </div>\r\n        <AttendancePanel v-model=\"attendance\" />\r\n      </v-col>\r\n      <v-col cols=6>\r\n        <h4>Output Spreadsheet</h4>\r\n        <v-btn color=\"primary\" :disabled=\"availableKeys.length == 0\" @click=\"addOutputCol\">Add Output Column</v-btn>\r\n        &nbsp;\r\n        <v-btn color=\"primary\" :disabled=\"cantExport\" @click=\"exportSheet\">Export Spreadsheet</v-btn>\r\n        <br />\r\n        <v-switch label=\"Remove students without any results\" v-model=\"dropEmptyStudents\" />\r\n        <div v-if=\"this.availableKeys.length > 0\">\r\n          <h4>Key Column</h4>\r\n          <v-select :items=\"availableKeys\"\r\n                    v-model=\"keyColumn\"\r\n                    label=\"Key type\"\r\n                    outlined\r\n                    dense />\r\n        </div>\r\n        <div v-for=\"(col, idx) in outputColumns\" :key=\"'output-'+idx\">            \r\n          <h4>Output Column {{idx+1}}</h4>\r\n          <v-container class=\"dense\">\r\n            <v-row>\r\n              <v-col cols=\"6\" class=\"dense\">\r\n                  <SelectColumn v-model=\"outputColumns[idx]\" label=\"Source Column\"\r\n                                :availableColumns=\"availableColumns\"\r\n                                :availableKeys=\"availableKeys\" />\r\n              </v-col>\r\n              <v-col cols=\"6\" class=\"dense\">\r\n                <v-text-field label=\"Output Column Name\"\r\n                              v-model=\"col.outputName\"\r\n                              outlined\r\n                              dense />\r\n              </v-col>\r\n            </v-row>\r\n          </v-container>\r\n        </div>\r\n        <div v-if=\"this.availableColumns.length > 0\">\r\n          <h4>Filter Students</h4>\r\n          <v-switch v-model=\"addFilter\" :label=\"filterLabel\" />\r\n          <ConditionPanel v-show=\"addFilter\" :availableColumns=\"availableColumns\" :availableKeys=\"availableKeys\" \r\n                          @input=\"updateFilter\"/>\r\n        </div>\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n  import XLSX from 'xlsx';\r\n  import {processWorkbook, processCanvasWorkbook} from '../util/processWorkbook';\r\n  import exportColumns from '../util/exportColumns';\r\n  import AttendancePanel from './AttendancePanel';\r\n  import SelectColumn from './SelectColumn';\r\n  import ConditionPanel from './ConditionPanel';\r\n  \r\n  export default {\r\n    name: 'Combiner',\r\n    components: {\r\n      AttendancePanel, SelectColumn, ConditionPanel\r\n    },\r\n    data: () => ({\r\n      workbooks: [],\r\n      keyColumn: undefined,\r\n      outputColumns: [],\r\n      dropEmptyStudents: true,\r\n      attendance: null,\r\n      addFilter: false,\r\n      currentFilter: {}\r\n    }),\r\n    methods: {\r\n      clickOpen() {\r\n        this.$refs.openFileInput.click();\r\n      },\r\n      clickOpenCanvas() {\r\n        this.$refs.openCanvasInput.click();\r\n      },      \r\n      fileChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            const data = new Uint8Array(ev2.target.result);\r\n            const workbook = XLSX.read(data, {type: 'array'});\r\n            const process = processWorkbook(workbook);\r\n            const wb = {filename: file.name, workbook, ...process};\r\n            wb.frames.forEach(frame => frame.includeStudents = true);\r\n            this.workbooks.push(wb);\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },\r\n      canvasFileChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            const data = new Uint8Array(ev2.target.result);\r\n            const workbook = XLSX.read(data, {type: 'array'});\r\n            const process = processCanvasWorkbook(workbook);\r\n            const wb = {filename: file.name, workbook, ...process};\r\n            wb.frames.forEach(frame => frame.includeStudents = true);\r\n            this.workbooks.push(wb);\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },      \r\n      addOutputCol() {\r\n        this.outputColumns.push(\r\n          {\r\n             outputKey: this.availableKeys[0],\r\n             outputColumn: this.availableColumns[0],\r\n             outputName: this.availableColumns[0].column\r\n          }\r\n        );\r\n      },\r\n      exportSheet() {\r\n        const table = exportColumns.makeTable(this.keyColumn, this.allKeys, this.selectedColumns, this.dropEmptyStudents, this.activeFilter);\r\n        const wb = XLSX.utils.book_new(), ws = XLSX.utils.aoa_to_sheet(table);\r\n        XLSX.utils.book_append_sheet(wb, ws, 'Output');\r\n        XLSX.writeFile(wb, 'output.xlsx');\r\n      },\r\n      updateFilter(val) {\r\n        this.currentFilter = val;\r\n      }\r\n    },\r\n    computed: {\r\n      activeFilter() {\r\n        if (this.addFilter) {\r\n          return this.currentFilter;\r\n        }\r\n        return null;\r\n      },\r\n      availableColumns() {\r\n        const result = [];\r\n        let idx = 0;\r\n        for (let wb of this.workbooks) {\r\n          for (let frame of wb.frames) {\r\n            for (let column of frame.df.columns) {\r\n              result.push({type: 'df', wb, frame, column, index: idx++})\r\n            }\r\n          }\r\n        }\r\n        if (this.attendance) {\r\n          result.push({type: 'attendance-bool', column: 'Attendance',index: idx++, data: this.attendance});\r\n          result.push({type: 'attendance-cat', column: 'Attendance Status',index: idx++, data: this.attendance});\r\n          result.push({type: 'attendance-count', column: 'Attendance Count',index: idx++, data: this.attendance});\r\n        }\r\n        return result;\r\n      },\r\n      availableKeys() {\r\n        const keys = new Set();\r\n        for (let wb of this.workbooks) {\r\n          for (let frame of wb.frames) {\r\n            for (const key of Object.values(frame.keys)) {\r\n              keys.add(key.type);\r\n            }\r\n          }\r\n        }\r\n        return Array.from(keys).sort();\r\n      },\r\n      allKeys() {\r\n        let keys = new Set();\r\n        for (let wb of this.workbooks) {\r\n          for (let frame of wb.frames) {\r\n            if (frame.includeStudents && this.keyColumn && frame.keys[this.keyColumn]) {\r\n              const kc = frame.keys[this.keyColumn];\r\n              for (let key of kc.keys) {\r\n                keys.add(key);\r\n              }\r\n            }\r\n          }  \r\n        }\r\n        keys = Array.from(keys).sort();\r\n        return keys;\r\n      },\r\n      selectedColumns() {\r\n        const result = [];\r\n        for (let oc of this.outputColumns) {\r\n          const colIndex = oc.outputColumn.index;\r\n          const col = this.availableColumns[colIndex];\r\n          const name = oc.outputName;\r\n          result.push({name, data: col});\r\n        }\r\n        return result;\r\n      },\r\n      cantExport() {\r\n        return !this.keyColumn || this.outputColumns.length == 0;\r\n      },\r\n      filterLabel() {\r\n        if (this.addFilter) {\r\n          return 'Only students where the following condition holds are included:';\r\n        }\r\n        return 'All students are included';\r\n      }\r\n    },\r\n    watch: {\r\n      availableKeys() {\r\n        if (!this.keyColumn && this.availableKeys.length > 0) {\r\n          this.keyColumn = this.availableKeys[0];\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.outputCol {\r\n  padding: 1em;\r\n}\r\n.dense {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Combiner.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Combiner.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Combiner.vue?vue&type=template&id=326983c4&scoped=true&\"\nimport script from \"./Combiner.vue?vue&type=script&lang=js&\"\nexport * from \"./Combiner.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Combiner.vue?vue&type=style&index=0&id=326983c4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"326983c4\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardActions,VCardTitle,VCol,VContainer,VRow,VSelect,VSwitch,VTextField})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h2',[_vm._v(\"Inject Results\")]),_c('p',[_vm._v(\"Read final course results from one dataset and inject those results into the official SPD spreadsheet to be loaded into Osiris. The free version of SheetJS strips the styling and layout from the output spreadsheet. I am not sure if that is a problem for SPD, but it is easy to copy paste the results in the official sheet to work around this. \")]),_c('p',[_c('strong',[_vm._v(\"Note:\")]),_vm._v(\" attendance data is not required; if you don't have mandatory attendance, you can just skip adding the attendance spreadsheet. \")])])],1),_c('v-row',[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h4',[_vm._v(\"Input Spreadsheets (Course Results)\")]),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickOpen}},[_vm._v(\"Select Source Spreadsheet\")]),_c('input',{ref:\"openFileInput\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xlsx\"},on:{\"change\":_vm.fileChosen}}),_c('br'),(_vm.sourceBook)?_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.sourceBook.filename))]),_c('v-card-text',[_c('h5',[_vm._v(\"The following sheets were found\")]),_vm._l((_vm.sourceBook.frames),function(frame){return _c('v-list-item',{key:frame.sheetName},[_c('v-list-item-content',[_vm._v(_vm._s(frame.sheetName))])],1)}),(_vm.sourceBook.skipped.length > 0)?_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" \"+_vm._s(_vm.sourceBook.skipped.length)+\" sheets were skipped \")]):_vm._e()],2)],1):_vm._e(),_c('AttendancePanel',{model:{value:(_vm.attendance),callback:function ($$v) {_vm.attendance=$$v},expression:\"attendance\"}})],1),_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h4',[_vm._v(\"Target Spreadsheet (as provided by SPD)\")]),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickOpenTarget}},[_vm._v(\"Set Target Spreadsheet\")]),_vm._v(\" \"),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":!_vm.injectionResults},on:{\"click\":_vm.downloadResult}},[_vm._v(\" Export Results\")]),_vm._v(\" \"),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":!_vm.injectionResults || !_vm.injectionResults.missing || _vm.injectionResults.missing.length == 0},on:{\"click\":_vm.downloadMissing}},[_vm._v(\" Export Missing\")]),_c('input',{ref:\"openFileTarget\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xlsx\"},on:{\"change\":_vm.fileTargetChosen}}),(_vm.attendance)?_c('v-switch',{attrs:{\"label\":\"Invalid result for students with insufficient attendance\"},model:{value:(_vm.useAttendance),callback:function ($$v) {_vm.useAttendance=$$v},expression:\"useAttendance\"}}):_vm._e(),(_vm.targetFilename)?_c('h5',[_vm._v(\"Target Spreadsheet: \"+_vm._s(_vm.targetFilename))]):_c('h5',[_vm._v(\"Target Spreadsheet: not set\")]),_c('v-select',{staticClass:\"margin-top\",attrs:{\"disabled\":_vm.availableColumns.length == 0,\"items\":_vm.availableColumns,\"item-text\":_vm.availableColumnToText,\"item-value\":_vm.availableColumnToValue,\"label\":\"Source Column\",\"outlined\":\"\"},model:{value:(_vm.sourceColumn),callback:function ($$v) {_vm.sourceColumn=$$v},expression:\"sourceColumn\"}}),(_vm.injectionResults && _vm.injectionResults.missing && _vm.injectionResults.missing.length > 0)?_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" There are \"+_vm._s(_vm.injectionResults.missing.length)+\" students who were missing in the injection target. \")]):_vm._e(),(_vm.injectionResults && _vm.injectionResults.errors.length > 0)?[_c('br'),_c('v-alert',{attrs:{\"type\":\"error\"}},[_vm._v(\" There were \"+_vm._s(_vm.injectionResults.errors.length)+\" errors while injecting results. \")]),_c('v-expansion-panels',[_c('v-expansion-panel',[_c('v-expansion-panel-header',[_vm._v(\" View Errors \")]),_c('v-expansion-panel-content',[_c('ul',_vm._l((_vm.injectionResults.errors),function(err,idx){return _c('li',{key:'error-'+idx},[_vm._v(\" \"+_vm._s(err)+\" \")])}),0)])],1)],1)]:_vm._e(),(_vm.injectionResults && _vm.injectionResults.warnings && _vm.injectionResults.warnings.length > 0)?[_c('br'),_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" There were \"+_vm._s(_vm.injectionResults.warnings.length)+\" warnings while injecting results. \")]),_c('v-expansion-panels',[_c('v-expansion-panel',[_c('v-expansion-panel-header',[_vm._v(\" View Warnings \")]),_c('v-expansion-panel-content',[_c('ul',_vm._l((_vm.injectionResults.warnings),function(warning,idx){return _c('li',{key:'warning-'+idx},[_vm._v(\" \"+_vm._s(warning)+\" \")])}),0)])],1)],1)]:_vm._e()],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const THRESHOLD = 10e-8;\r\n\r\nconst GradingPolicy = {\r\n    alternatives: ['VD', 'NVD', 'VR', 'GGR', 'ONV', 'NO', 'FR'],\r\n    missingValue: 'NO',\r\n    invalidResult: 'GGR',\r\n    minGrade: 1,\r\n    maxGrade: 10,\r\n    roundingRule(num) {\r\n        return Math.floor(THRESHOLD + num*10)/10;\r\n    },\r\n    truncateRule(num) {\r\n        return Math.max(this.minGrade, Math.min(this.maxGrade, num));\r\n    },\r\n    finalize(value,invalidAttendance=false) {\r\n        if (this.alternatives.includes(value)) {\r\n            return value;\r\n        }\r\n        if (invalidAttendance) {\r\n            return 'GGR';\r\n        }\r\n        let num = parseFloat(value);\r\n        num = this.roundingRule(num);\r\n        num = this.truncateRule(num);\r\n        return num.toFixed(1);\r\n    },\r\n    checkError(value) {\r\n        if (this.alternatives.includes(value)) {\r\n            return false;\r\n        }\r\n        try {\r\n            let num = parseFloat(value);\r\n            if (Number.isNaN(num)) {\r\n                return 'Value '+value+' is not a valid result';\r\n            }\r\n            return false;\r\n        }\r\n        catch (err) {\r\n            return err.message;\r\n        }\r\n    },\r\n    checkWarning(value) {\r\n        if (this.alternatives.includes(value)) {\r\n            return false;\r\n        }\r\n        let num = parseFloat(value);\r\n        if (num < this.minGrade) {\r\n            return 'Grade can not be smaller than '+this.minGrade+'. Set to '+this.minGrade;\r\n        }\r\n        if (num > this.maxGrade) {\r\n            return 'Grade can not be greater than '+this.maxGrade+'. Set to '+this.maxGrade;\r\n        }\r\n    }\r\n\r\n};\r\n\r\nexport default GradingPolicy;","import exportColumns from '../util/exportColumns';\r\nimport XLSX from 'xlsx';\r\n\r\nconst SHEET_NAME = 'Toetslijst';\r\nconst ID_CELL = 'A8';\r\nconst ID_VAL = 'Studentnummer';\r\nconst ID_COL_INDEX = 0;\r\nconst RES_CELL = 'D8';\r\nconst RES_VAL = 'Resultaat';\r\nconst RES_COL_INDEX = 3;\r\nconst FIRST_ROW = 8;\r\n\r\n// TODO: this should definitely be a lot more flexible\r\nconst OUTPUT_KEY = 'erna';\r\nconst SHEET_KEY = 'student number';\r\n\r\nfunction resultPreflight(id, result, errors, warnings, gradingPolicy, failedAtt) {\r\n    if (result) {\r\n        const error = gradingPolicy.checkError(result);\r\n        if (error) {\r\n            errors.push('Error for student '+id+' : '+error);\r\n            return null;\r\n        }\r\n        const warning = gradingPolicy.checkWarning(result);\r\n        if (warning) {\r\n            warnings.push('Warning for student '+id+' : '+warning);\r\n            return gradingPolicy.finalize(result);\r\n        }\r\n        else {\r\n            return gradingPolicy.finalize(result, failedAtt);\r\n        }\r\n    }\r\n    else {\r\n        warnings.push('Injected '+gradingPolicy.missingValue\r\n            +' for student '+id+' since there was no data.' );\r\n        return gradingPolicy.missingValue;\r\n    }\r\n}\r\n\r\nfunction attendanceKeys(attendance) {\r\n    const result = {};\r\n    if (attendance) {\r\n        for (const key of Object.keys(attendance.data)) {\r\n            result[key.substring(0,6)] = key;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction checkAttendanceFailed(attendance, id, attendanceMap) {\r\n    if (!attendance) {\r\n        return false;\r\n    }\r\n    const convId = attendanceMap[id];\r\n    if (!convId || !attendance.data[convId]) {\r\n        // No data for this student\r\n        return true;\r\n    }\r\n    const data = attendance.data[convId];\r\n    //console.log(data);\r\n    if (data.exemption) {\r\n        return false;\r\n    }\r\n    return data.sessionsPresent.size < attendance.threshold;\r\n}\r\n\r\nfunction processResult(column, gradingPolicy, identityConfig, attendance) {\r\n    const erna_dataset = exportColumns.columnToDataset(column, OUTPUT_KEY);\r\n    const attendanceMap = attendanceKeys(attendance);\r\n    const std_dataset = {};\r\n    const errors = [], warnings = [];\r\n    for (let [key, result] of Object.entries(erna_dataset)) {\r\n        const conv_key = identityConfig.convert(OUTPUT_KEY, SHEET_KEY, key);\r\n        let failedAtt = checkAttendanceFailed(attendance, conv_key, attendanceMap);\r\n        const res = resultPreflight(conv_key, result, errors, warnings, gradingPolicy, failedAtt);\r\n        std_dataset[conv_key] = res;\r\n    }\r\n    return {data: std_dataset, errors, warnings};\r\n}\r\n\r\nfunction checkSheetStructure(sheet, errors) {\r\n    const idcell = sheet[ID_CELL];\r\n    const rescell = sheet[RES_CELL];\r\n    if (!idcell || idcell.v != ID_VAL) {\r\n        errors.push('Incorrect structure for target file. Value \"'+ID_VAL+'\" was not found in Cell '+ID_CELL);\r\n        return false;\r\n    }\r\n    else if (!rescell || rescell.v != RES_VAL) {\r\n        errors.push('Incorrect structure for target file. Value \"'+RES_VAL+'\" was not found in Cell '+RES_CELL);\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction injectResults(column, wb, gradingPolicy, identityConfig, attendance) {\r\n    const errors = [], warnings = [], missing = [];\r\n    const sheet = wb.Sheets[SHEET_NAME];\r\n    const attendanceMap = attendanceKeys(attendance);\r\n    if (sheet && checkSheetStructure(sheet, errors)) {\r\n        // Proceed\r\n        const processed = new Set();\r\n        // const erna_dataset = exportColumns.columnToDataset(column, OUTPUT_KEY);\r\n        // const std_dataset = {};\r\n        // for (let [key, val] of Object.entries(erna_dataset)) {\r\n        //     const conv_key = identityConfig.convert(OUTPUT_KEY, SHEET_KEY, key);\r\n        //     std_dataset[conv_key] = val;\r\n        // }\r\n        const std_dataset = exportColumns.columnToDataset(column, SHEET_KEY);\r\n        const range = XLSX.utils.decode_range(sheet['!ref']);\r\n        for (let row = FIRST_ROW; row <= range.e.r; row++) {\r\n            const id_ref = XLSX.utils.encode_cell({ c: ID_COL_INDEX, r: row });\r\n            const res_ref = XLSX.utils.encode_cell({ c: RES_COL_INDEX, r: row });\r\n            const idcell = sheet[id_ref];\r\n            let rescell = sheet[res_ref];\r\n            if (!rescell) {\r\n                sheet[res_ref] = {t: 's', v: null};\r\n                rescell = sheet[res_ref];\r\n            }\r\n            const id = idcell.v;\r\n            let failedAtt = checkAttendanceFailed(attendance, id, attendanceMap);\r\n            if (id) {\r\n                processed.add(id);\r\n                const result = std_dataset[id];\r\n                //console.log(result, id, std_dataset);\r\n                rescell.v = resultPreflight(id, result, errors, warnings, gradingPolicy, failedAtt);\r\n                console.log(id, rescell.v);\r\n            }\r\n        }\r\n\r\n        for (let [id,result] of Object.entries(std_dataset)) {\r\n            let failedAtt = checkAttendanceFailed(attendance, id, attendanceMap);\r\n            if (!processed.has(id)) {\r\n                missing.push({id, result: resultPreflight(id, result, errors, warnings, gradingPolicy, failedAtt)});\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        errors.push('Incorrect structure for target file. Sheet '+SHEET_NAME+' was expected but not found');\r\n    }\r\n    return {wb, errors, warnings, missing};\r\n}\r\n\r\nfunction removeRowsFromSheet(rows, sheet) {\r\n    if (!rows.length) {\r\n        return;\r\n    }\r\n    const range = XLSX.utils.decode_range(sheet['!ref']);\r\n    const rs = rows.filter(i => i >= range.s.r && i <= range.e.r).sort((i,j) => i-j);\r\n    let skip = 0;\r\n    for (let r = range.s.r; r <= range.e.r; r++) {\r\n        if (skip < rs.length && r == rs[skip]) {\r\n            // This row should be skipped, delete the cells\r\n            for (let c=range.s.c; c <= range.e.c; c++) {\r\n                const cell_ref = XLSX.utils.encode_cell({c, r});\r\n                if (sheet[cell_ref]) {\r\n                    delete sheet[cell_ref];\r\n                }\r\n            }\r\n            skip++;\r\n        }\r\n        else {\r\n            if (skip == 0) {\r\n                // No need to skip yet\r\n                continue;\r\n            }\r\n            for (let c=range.s.c; c <= range.e.c; c++) {\r\n                const cell_ref = XLSX.utils.encode_cell({c, r});\r\n                const shift_ref = XLSX.utils.encode_cell({c, r: r-skip});\r\n                if (sheet[cell_ref]) {\r\n                    sheet[shift_ref] = sheet[cell_ref];\r\n                    delete sheet[cell_ref];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n        \r\n}\r\n\r\nfunction mutateResults(results, wb) {\r\n    const errors = [], warnings = [], missing = [];\r\n    const sheet = wb.Sheets[SHEET_NAME];\r\n    if (sheet && checkSheetStructure(sheet, errors)) {\r\n        const remove_rows = [];\r\n        const range = XLSX.utils.decode_range(sheet['!ref']);\r\n        for (let row = FIRST_ROW; row <= range.e.r; row++) {\r\n            const id_ref = XLSX.utils.encode_cell({ c: ID_COL_INDEX, r: row });\r\n            const res_ref = XLSX.utils.encode_cell({ c: RES_COL_INDEX, r: row });\r\n            const idcell = sheet[id_ref];\r\n            const id = idcell.v;\r\n            if (id && results[id]) {\r\n                const res = results[id];\r\n                const rescell = sheet[res_ref];\r\n                if (!rescell) {\r\n                    sheet[res_ref] = {t: 's', v: res};\r\n                }\r\n                else {\r\n                    rescell.v = res;\r\n                }\r\n            }  \r\n            else {\r\n                remove_rows.push(row);\r\n            }\r\n        }\r\n        removeRowsFromSheet(remove_rows, sheet);\r\n    }\r\n    else {\r\n        errors.push('Incorrect structure for target file. Sheet '+SHEET_NAME+' was expected but not found');\r\n    }\r\n    return {wb, errors, warnings, missing};\r\n}\r\n\r\nfunction readResultEntries(wb) {\r\n    const errors = [], warnings = [], missing = [];\r\n    const sheet = wb.Sheets[SHEET_NAME];\r\n    const std_dataset = {};\r\n    if (sheet && checkSheetStructure(sheet, errors)) {\r\n        // Proceed\r\n        const range = XLSX.utils.decode_range(sheet['!ref']);\r\n        for (let row = FIRST_ROW; row <= range.e.r; row++) {\r\n            const id_ref = XLSX.utils.encode_cell({ c: ID_COL_INDEX, r: row });\r\n            const res_ref = XLSX.utils.encode_cell({ c: RES_COL_INDEX, r: row });\r\n            const idcell = sheet[id_ref];\r\n            const rescell = sheet[res_ref];\r\n            const key = idcell ? idcell.v : undefined;\r\n            const result = rescell ? rescell.v : undefined;\r\n            if (!key) {\r\n                continue;\r\n            }\r\n            if (result) {\r\n                std_dataset[key] = {result, student: key, row};\r\n            }\r\n            else {\r\n                warnings.push('Missing result for student '+key+' in row '+row);\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        errors.push('Incorrect structure for target file. Sheet '+SHEET_NAME+' was expected but not found');\r\n    }\r\n    return {entries: std_dataset, errors, warnings, missing};\r\n}\r\n\r\nexport {injectResults, readResultEntries, processResult, mutateResults};\r\n","<template>\r\n  <v-container>\r\n    <v-row align=\"center\" justify=\"center\">\r\n      <v-col cols=\"6\">\r\n        <h2>Inject Results</h2>\r\n        <p>Read final course results from one dataset and inject those results\r\n           into the official SPD spreadsheet to be loaded into Osiris.\r\n           The free version of SheetJS strips the styling and layout from the\r\n           output spreadsheet. I am not sure if that is a problem for SPD,\r\n           but it is easy to copy paste the results in the official sheet to\r\n           work around this.\r\n        </p>\r\n        <p>\r\n            <strong>Note:</strong> attendance data is not required; if you don't\r\n            have mandatory attendance, you can just skip adding the attendance\r\n            spreadsheet.\r\n        </p>\r\n      </v-col>\r\n    </v-row>\r\n    <v-row>\r\n      <v-col cols=\"6\">\r\n        <h4>Input Spreadsheets (Course Results)</h4>\r\n        <v-btn color=\"primary\" @click=\"clickOpen\">Select Source Spreadsheet</v-btn>\r\n        <input type=\"file\" style=\"display: none\" ref=\"openFileInput\"\r\n                accept=\".xlsx\" @change=\"fileChosen\" />\r\n\r\n        <br />\r\n        <v-card v-if=\"sourceBook\">\r\n          <v-card-title>{{sourceBook.filename}}</v-card-title>\r\n          <v-card-text>\r\n            <h5>The following sheets were found</h5>\r\n            <v-list-item v-for=\"frame in sourceBook.frames\" :key=\"frame.sheetName\">\r\n              <v-list-item-content>{{frame.sheetName}}</v-list-item-content>\r\n            </v-list-item>\r\n            <v-alert v-if=\"sourceBook.skipped.length > 0\" type=\"warning\">\r\n              {{sourceBook.skipped.length}} sheets were skipped\r\n            </v-alert>              \r\n          </v-card-text>\r\n        </v-card>\r\n        <AttendancePanel v-model=\"attendance\" />\r\n      </v-col>\r\n      <v-col cols=6>\r\n        <h4>Target Spreadsheet (as provided by SPD)</h4>\r\n        <v-btn color=\"primary\" @click=\"clickOpenTarget\">Set Target Spreadsheet</v-btn>\r\n        &nbsp;\r\n        <v-btn color=\"primary\" @click=\"downloadResult\" :disabled=\"!injectionResults\">\r\n          Export Results</v-btn>\r\n        &nbsp;\r\n        <v-btn color=\"primary\" @click=\"downloadMissing\" :disabled=\"!injectionResults || !injectionResults.missing || injectionResults.missing.length == 0\">\r\n          Export Missing</v-btn>          \r\n        <input type=\"file\" style=\"display: none\" ref=\"openFileTarget\"\r\n                accept=\".xlsx\" @change=\"fileTargetChosen\" />\r\n        <v-switch label=\"Invalid result for students with insufficient attendance\" v-if=\"attendance\" v-model=\"useAttendance\" />\r\n        \r\n        <h5 v-if=\"targetFilename\">Target Spreadsheet: {{targetFilename}}</h5>\r\n        <h5 v-else>Target Spreadsheet: not set</h5>\r\n        <v-select\r\n          class=\"margin-top\"\r\n          :disabled=\"availableColumns.length == 0\"\r\n          :items=\"availableColumns\"\r\n          :item-text=\"availableColumnToText\"\r\n          :item-value=\"availableColumnToValue\"\r\n          v-model=\"sourceColumn\"\r\n          label=\"Source Column\"\r\n          outlined />\r\n        <v-alert v-if=\"injectionResults && injectionResults.missing && injectionResults.missing.length > 0\" type=\"warning\">\r\n          There are {{injectionResults.missing.length}} students who were missing\r\n          in the injection target.\r\n        </v-alert>\r\n        <template v-if=\"injectionResults && injectionResults.errors.length > 0\">\r\n          <br />\r\n          <v-alert type=\"error\">\r\n            There were {{injectionResults.errors.length}} errors while injecting results.\r\n          </v-alert>\r\n          <v-expansion-panels>\r\n            <v-expansion-panel>\r\n              <v-expansion-panel-header>\r\n                View Errors \r\n              </v-expansion-panel-header>\r\n              <v-expansion-panel-content>\r\n                <ul>\r\n                  <li v-for=\"(err,idx) in injectionResults.errors\" :key=\"'error-'+idx\">\r\n                    {{err}}\r\n                  </li>\r\n                </ul>\r\n              </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n          </v-expansion-panels>\r\n        </template>\r\n        <template v-if=\"injectionResults && injectionResults.warnings && injectionResults.warnings.length > 0\">\r\n          <br />\r\n          <v-alert type=\"warning\">\r\n            There were {{injectionResults.warnings.length}} warnings while injecting results.\r\n          </v-alert>\r\n          <v-expansion-panels>\r\n            <v-expansion-panel>\r\n              <v-expansion-panel-header>\r\n                View Warnings\r\n              </v-expansion-panel-header>\r\n              <v-expansion-panel-content>\r\n                <ul>\r\n                  <li v-for=\"(warning,idx) in injectionResults.warnings\" :key=\"'warning-'+idx\">\r\n                    {{warning}}\r\n                  </li>\r\n                </ul>\r\n              </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n          </v-expansion-panels>\r\n        </template>\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n  import XLSX from 'xlsx';\r\n  import {processWorkbook} from '../util/processWorkbook';\r\n  import GradingPolicy from '../util/GradingPolicy';\r\n  import IdentityConfig from '../util/IdentityConfig';\r\n  import {injectResults} from '../util/injectResults';\r\n  import AttendancePanel from './AttendancePanel';\r\n\r\n  export default {\r\n    name: 'Injector',\r\n    components: {\r\n      AttendancePanel\r\n    },\r\n    data: () => ({\r\n      attendance: null,\r\n      useAttendance: true,\r\n      sourceBook: null,\r\n      sourceColumn: null,\r\n      rawTarget: null,\r\n      targetFilename: null,\r\n      dropEmptyStudents: false\r\n    }),\r\n    methods: {\r\n      clickOpen() {\r\n        this.$refs.openFileInput.click();\r\n      },\r\n      clickOpenTarget() {\r\n        this.$refs.openFileTarget.click();\r\n      },\r\n       fileChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            const data = new Uint8Array(ev2.target.result);\r\n            const workbook = XLSX.read(data, {type: 'array'});\r\n            const process = processWorkbook(workbook);\r\n            const wb = {filename: file.name, workbook, ...process};\r\n            this.sourceBook = wb;\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },\r\n      fileTargetChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          this.rawTarget = null;\r\n          this.target = null;\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            this.rawTarget = new Uint8Array(ev2.target.result);\r\n            this.targetFilename = file.name;\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },      \r\n      availableColumnToText(c) {\r\n        //console.log(c);\r\n        if (c.wb && c.wb.filename) {\r\n          return c.wb.filename + ' / ' + c.frame.sheetName + ' / ' + c.column;\r\n        }\r\n        else if (c.frame && c.frame.sheetName && c.column) {\r\n          return 'Unknown Workbook / ' + c.frame.sheetName + ' / ' + c.column;\r\n        }\r\n        else if (c.column) {\r\n          return 'Unknown Workbook / Unknown Sheet / ' + c.column;\r\n        }\r\n        return '[ERROR - Unknown Column]';\r\n      },\r\n      availableColumnToValue(c) {\r\n        return {index: c.index, column: c.column};\r\n      },\r\n      addOutputCol() {\r\n        this.outputColumns.push(\r\n          {\r\n             outputKey: this.availableKeys[0],\r\n             outputColumn: this.availableColumns[0],\r\n             outputName: this.availableColumns[0].column\r\n          }\r\n        );\r\n      },\r\n      updateSourceColumn(newVal, col) {\r\n        col.outputColumn = newVal;\r\n        col.outputName = newVal.column;\r\n      },\r\n      downloadResult() {\r\n        if (this.injectionResults && this.injectionResults.wb) {\r\n          const fname = this.targetFilename.replace('.xlsx','-injected.xlsx');\r\n          XLSX.writeFile(this.injectionResults.wb, fname);\r\n        }\r\n      },\r\n      downloadMissing() {\r\n        if (this.injectionResults && this.injectionResults.missing && this.injectionResults.missing.length > 0) {\r\n          const table = [['Student','Result']];\r\n          for (let entry of this.injectionResults.missing) {\r\n            table.push([entry.id, entry.result]);\r\n          }\r\n          const fname = this.targetFilename.replace('.xlsx','-missing.xlsx');\r\n          const wb = XLSX.utils.book_new(), ws = XLSX.utils.aoa_to_sheet(table);\r\n          XLSX.utils.book_append_sheet(wb, ws, 'Missing');\r\n          XLSX.writeFile(wb, fname);\r\n        }\r\n      }\r\n    },\r\n    computed: {\r\n      injectionResults() {\r\n        if (this.rawTarget && this.selectedColumn) {\r\n            try {\r\n              const wb = XLSX.read(this.rawTarget, {type: 'array', cellStyles:true});\r\n              const passAtt = this.attendance && this.useAttendance ? this.attendance : null;\r\n              const result = injectResults(this.selectedColumn, wb, GradingPolicy, IdentityConfig, passAtt);\r\n              return result;\r\n            }\r\n            catch (err) {\r\n              console.log(err);\r\n              return {errors: ['Error while processing target spreadsheet: ' + err.message]};\r\n            }\r\n        }\r\n        return null;\r\n      },\r\n      availableColumns() {\r\n        const result = [];\r\n        let idx = 0;\r\n        if (this.sourceBook) {\r\n          for (let frame of this.sourceBook.frames) {\r\n            for (let column of frame.df.columns) {\r\n              result.push({wb: this.sourceBook, frame, column, index: idx++, type: 'df'})\r\n            }\r\n          }\r\n        }\r\n        return result;\r\n      },\r\n      allKeys() {\r\n        let keys = new Set();\r\n        if (this.sourceBook) {\r\n          for (let frame of this.sourceBook.frames) {\r\n            if (frame.includeStudents && this.keyColumn && frame.keys[this.keyColumn]) {\r\n              const kc = frame.keys[this.keyColumn];\r\n              for (let key of kc.keys) {\r\n                keys.add(key);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        keys = Array.from(keys).sort();\r\n        return keys;\r\n      },\r\n      selectedColumn() {\r\n        if (this.sourceColumn) {\r\n          const colIndex = this.sourceColumn.index;\r\n          const col = this.availableColumns[colIndex];\r\n          return col;\r\n        }\r\n        return null;\r\n      },\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.margin-top {\r\n  margin-top: 1em;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Injector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Injector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Injector.vue?vue&type=template&id=620d0028&scoped=true&\"\nimport script from \"./Injector.vue?vue&type=script&lang=js&\"\nexport * from \"./Injector.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Injector.vue?vue&type=style&index=0&id=620d0028&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"620d0028\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VExpansionPanel } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanelContent } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanelHeader } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanels } from 'vuetify/lib/components/VExpansionPanel';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardText,VCardTitle,VCol,VContainer,VExpansionPanel,VExpansionPanelContent,VExpansionPanelHeader,VExpansionPanels,VListItem,VListItemContent,VRow,VSelect,VSwitch})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('h2',[_vm._v(\"Mutate Results\")]),_c('p',[_vm._v(\"If course results have been established, this workflow can compare the submitted grades to a spreadsheet with updated course results. The output is an SPD spreadsheet which only contains the results that have changed. If you already made mutations before, it is also possible to add some of these mutation spreadsheets submitted to SPD. This way, the output spreadsheet generated only contains the course results that must be mutated by SPD. \")])])],1),_c('v-row',[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\"Input Spreadsheet: (Updated) Course Results\")]),_c('v-card-text',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickOpen}},[_vm._v(\"Select Source Spreadsheet\")]),_c('input',{ref:\"openFileInput\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xlsx\"},on:{\"change\":_vm.fileChosen}}),_vm._v(\" \"),_c('AttendancePanel',{model:{value:(_vm.attendance),callback:function ($$v) {_vm.attendance=$$v},expression:\"attendance\"}})],1)],1),_c('br'),(_vm.sourceBook)?_c('v-card',[_c('v-card-title',[_vm._v(_vm._s(_vm.sourceBook.filename))]),_c('v-card-text',[_c('h5',[_vm._v(\"The following sheets were found\")]),_vm._l((_vm.sourceBook.frames),function(frame){return _c('v-list-item',{key:frame.sheetName},[_c('v-list-item-content',[_vm._v(_vm._s(frame.sheetName))])],1)}),(_vm.sourceBook.skipped.length > 0)?_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" \"+_vm._s(_vm.sourceBook.skipped.length)+\" sheets were skipped \")]):_vm._e()],2)],1):_vm._e(),_c('v-card',[_c('v-card-title',[_vm._v(\"Injection Target Spreadsheet (provided by/submitted to SPD)\")]),_c('v-card-text',[_c('v-card',{attrs:{\"flat\":\"\"}},[(_vm.targetData)?_c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(\"Injection Target: \"+_vm._s(_vm.targetData.name))]),_c('v-card-subtitle',[_vm._v(\"Date: \"+_vm._s(_vm.targetData.date)+\", \"),_c('br'),_vm._v(\" Entries: \"+_vm._s(Object.keys(_vm.targetData.data.entries).length))])],1):_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\"Injection Target spreadsheet not set\")])],1),_vm._l((_vm.mutations),function(mut,mutIdx){return [_c('v-card',{key:'mut-'+mutIdx,attrs:{\"flat\":\"\"}},[_c('v-card-title',[_vm._v(\"Mutation \"+_vm._s(mutIdx + 1)+\" - \"+_vm._s(mut.name))]),_c('v-card-subtitle',[_vm._v(\"Date: \"+_vm._s(mut.date)+\", \"),_c('br'),_vm._v(\"Entries: \"+_vm._s(Object.keys(mut.data.entries).length))])],1)]})],2),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickOpenTarget}},[_vm._v(\"Set Target Spreadsheet\")]),_vm._v(\" \"),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.clickAddMutation}},[_vm._v(\"Add Mutations\")])],1)],1),_c('input',{ref:\"addMutations\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xlsx\"},on:{\"change\":_vm.addMutationsChosen}})],1),_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":!_vm.injectionResults},on:{\"click\":_vm.downloadResult}},[_vm._v(\" Export Results\")]),_vm._v(\" \"),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":!_vm.injectionResults || _vm.injectionResults.missing.length == 0},on:{\"click\":_vm.downloadMissing}},[_vm._v(\" Export Missing\")]),_c('input',{ref:\"openFileTarget\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\".xlsx\"},on:{\"change\":_vm.fileTargetChosen}}),(_vm.attendance)?_c('v-switch',{attrs:{\"label\":\"Invalid result for students with insufficient attendance\"},model:{value:(_vm.useAttendance),callback:function ($$v) {_vm.useAttendance=$$v},expression:\"useAttendance\"}}):_vm._e(),(_vm.updatedResults)?_c('v-card',[_c('v-card-text',[_vm._v(\" \"+_vm._s(_vm.updatedResults.data)+\" \")])],1):_vm._e(),_c('v-select',{staticClass:\"margin-top\",attrs:{\"disabled\":_vm.availableColumns.length == 0,\"items\":_vm.availableColumns,\"item-text\":_vm.availableColumnToText,\"item-value\":_vm.availableColumnToValue,\"label\":\"Source Column\",\"outlined\":\"\"},model:{value:(_vm.sourceColumn),callback:function ($$v) {_vm.sourceColumn=$$v},expression:\"sourceColumn\"}}),(_vm.injectionResults && _vm.injectionResults.missing.length > 0)?_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" There are \"+_vm._s(_vm.injectionResults.missing.length)+\" students who were missing in the injection target. \")]):_vm._e(),(_vm.injectionResults && _vm.injectionResults.errors.length > 0)?[_c('br'),_c('v-alert',{attrs:{\"type\":\"error\"}},[_vm._v(\" There were \"+_vm._s(_vm.injectionResults.errors.length)+\" errors while injecting results. \")]),_c('v-expansion-panels',[_c('v-expansion-panel',[_c('v-expansion-panel-header',[_vm._v(\" View Errors \")]),_c('v-expansion-panel-content',[_c('ul',_vm._l((_vm.injectionResults.errors),function(err,idx){return _c('li',{key:'error-'+idx},[_vm._v(\" \"+_vm._s(err)+\" \")])}),0)])],1)],1)]:_vm._e(),(_vm.injectionResults && _vm.injectionResults.warnings.length > 0)?[_c('br'),_c('v-alert',{attrs:{\"type\":\"warning\"}},[_vm._v(\" There were \"+_vm._s(_vm.injectionResults.warnings.length)+\" warnings while injecting results. \")]),_c('v-expansion-panels',[_c('v-expansion-panel',[_c('v-expansion-panel-header',[_vm._v(\" View Warnings \")]),_c('v-expansion-panel-content',[_c('ul',_vm._l((_vm.injectionResults.warnings),function(warning,idx){return _c('li',{key:'warning-'+idx},[_vm._v(\" \"+_vm._s(warning)+\" \")])}),0)])],1)],1)]:_vm._e()],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-container>\r\n    <v-row align=\"center\" justify=\"center\">\r\n      <v-col cols=\"6\">\r\n        <h2>Mutate Results</h2>\r\n        <p>If course results have been established, this workflow can compare\r\n          the submitted grades to a spreadsheet with updated course results.\r\n          The output is an SPD spreadsheet which only contains the results\r\n          that have changed. If you already made mutations before, it is also\r\n          possible to add some of these mutation spreadsheets submitted to SPD.\r\n          This way, the output spreadsheet generated only contains the course\r\n          results that must be mutated by SPD.\r\n        </p>\r\n      </v-col>\r\n    </v-row>\r\n    <v-row>\r\n      <v-col cols=\"6\">\r\n        <v-card>\r\n        <v-card-title>Input Spreadsheet: (Updated) Course Results</v-card-title>\r\n        <v-card-text>\r\n          <v-btn color=\"primary\" @click=\"clickOpen\">Select Source Spreadsheet</v-btn>\r\n          <input type=\"file\" style=\"display: none\" ref=\"openFileInput\"\r\n                  accept=\".xlsx\" @change=\"fileChosen\" />\r\n          &nbsp;\r\n          <AttendancePanel v-model=\"attendance\" />\r\n        </v-card-text>\r\n        </v-card>\r\n        <br />\r\n        <v-card v-if=\"sourceBook\">\r\n          <v-card-title>{{sourceBook.filename}}</v-card-title>\r\n          <v-card-text>\r\n            <h5>The following sheets were found</h5>\r\n            <v-list-item v-for=\"frame in sourceBook.frames\" :key=\"frame.sheetName\">\r\n              <v-list-item-content>{{frame.sheetName}}</v-list-item-content>\r\n            </v-list-item>\r\n            <v-alert v-if=\"sourceBook.skipped.length > 0\" type=\"warning\">\r\n              {{sourceBook.skipped.length}} sheets were skipped\r\n            </v-alert>              \r\n          </v-card-text>\r\n        </v-card>\r\n        <v-card>\r\n          <v-card-title>Injection Target Spreadsheet (provided by/submitted to SPD)</v-card-title>\r\n          <v-card-text>\r\n            <v-card flat>\r\n              <v-card v-if=\"targetData\" flat>\r\n                <v-card-title>Injection Target: {{targetData.name}}</v-card-title>\r\n                <v-card-subtitle>Date: {{targetData.date}}, <br /> Entries: {{Object.keys(targetData.data.entries).length}}</v-card-subtitle>\r\n              </v-card>              \r\n           <v-alert v-else type=\"warning\">Injection Target spreadsheet not set</v-alert>\r\n          </v-card>\r\n          <template v-for=\"(mut,mutIdx) in mutations\">\r\n            <v-card :key=\"'mut-'+mutIdx\" flat>\r\n              <v-card-title>Mutation {{mutIdx + 1}} - {{mut.name}}</v-card-title>\r\n              <v-card-subtitle>Date: {{mut.date}}, <br />Entries: {{Object.keys(mut.data.entries).length}}</v-card-subtitle>\r\n            </v-card>\r\n          </template>\r\n          </v-card-text>\r\n          <v-card-actions>\r\n            <v-btn color=\"primary\" @click=\"clickOpenTarget\">Set Target Spreadsheet</v-btn>\r\n            &nbsp;\r\n            <v-btn color=\"primary\" @click=\"clickAddMutation\">Add Mutations</v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n        \r\n        <input type=\"file\" style=\"display: none\" ref=\"addMutations\"\r\n                accept=\".xlsx\" @change=\"addMutationsChosen\" />\r\n      </v-col>\r\n      <v-col cols=6>\r\n        <v-btn color=\"primary\" @click=\"downloadResult\" :disabled=\"!injectionResults\">\r\n          Export Results</v-btn>\r\n        &nbsp;\r\n        <v-btn color=\"primary\" @click=\"downloadMissing\" :disabled=\"!injectionResults || injectionResults.missing.length == 0\">\r\n          Export Missing</v-btn>          \r\n        <input type=\"file\" style=\"display: none\" ref=\"openFileTarget\"\r\n                accept=\".xlsx\" @change=\"fileTargetChosen\" />\r\n        <v-switch label=\"Invalid result for students with insufficient attendance\" v-if=\"attendance\" v-model=\"useAttendance\" />\r\n        \r\n        <v-card v-if=\"updatedResults\">\r\n          <v-card-text>\r\n            {{updatedResults.data}}\r\n          </v-card-text>\r\n        </v-card>\r\n\r\n        <v-select\r\n          class=\"margin-top\"\r\n          :disabled=\"availableColumns.length == 0\"\r\n          :items=\"availableColumns\"\r\n          :item-text=\"availableColumnToText\"\r\n          :item-value=\"availableColumnToValue\"\r\n          v-model=\"sourceColumn\"\r\n          label=\"Source Column\"\r\n          outlined />\r\n        <v-alert v-if=\"injectionResults && injectionResults.missing.length > 0\" type=\"warning\">\r\n          There are {{injectionResults.missing.length}} students who were missing\r\n          in the injection target.\r\n        </v-alert>\r\n        <template v-if=\"injectionResults && injectionResults.errors.length > 0\">\r\n          <br />\r\n          <v-alert type=\"error\">\r\n            There were {{injectionResults.errors.length}} errors while injecting results.\r\n          </v-alert>\r\n          <v-expansion-panels>\r\n            <v-expansion-panel>\r\n              <v-expansion-panel-header>\r\n                View Errors \r\n              </v-expansion-panel-header>\r\n              <v-expansion-panel-content>\r\n                <ul>\r\n                  <li v-for=\"(err,idx) in injectionResults.errors\" :key=\"'error-'+idx\">\r\n                    {{err}}\r\n                  </li>\r\n                </ul>\r\n              </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n          </v-expansion-panels>\r\n        </template>\r\n        <template v-if=\"injectionResults && injectionResults.warnings.length > 0\">\r\n          <br />\r\n          <v-alert type=\"warning\">\r\n            There were {{injectionResults.warnings.length}} warnings while injecting results.\r\n          </v-alert>\r\n          <v-expansion-panels>\r\n            <v-expansion-panel>\r\n              <v-expansion-panel-header>\r\n                View Warnings\r\n              </v-expansion-panel-header>\r\n              <v-expansion-panel-content>\r\n                <ul>\r\n                  <li v-for=\"(warning,idx) in injectionResults.warnings\" :key=\"'warning-'+idx\">\r\n                    {{warning}}\r\n                  </li>\r\n                </ul>\r\n              </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n          </v-expansion-panels>\r\n        </template>\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n  import XLSX from 'xlsx';\r\n  import {processWorkbook} from '../util/processWorkbook';\r\n  import GradingPolicy from '../util/GradingPolicy';\r\n  import IdentityConfig from '../util/IdentityConfig';\r\n  import {readResultEntries, processResult, mutateResults} from '../util/injectResults';\r\n  import AttendancePanel from './AttendancePanel';\r\n\r\n  export default {\r\n    name: 'Mutator',\r\n    components: {\r\n      AttendancePanel\r\n    },\r\n    data: () => ({\r\n      attendance: null,\r\n      useAttendance: true,\r\n      sourceBook: null,\r\n      sourceColumn: null,\r\n      rawTarget: null,\r\n      targetData: null,\r\n      mutations: [],\r\n      dropEmptyStudents: false\r\n    }),\r\n    methods: {\r\n      clickOpen() {\r\n        this.$refs.openFileInput.click();\r\n      },\r\n      clickOpenTarget() {\r\n        this.$refs.openFileTarget.click();\r\n      },\r\n      clickAddMutation() {\r\n        this.$refs.addMutations.click();\r\n      },\r\n       fileChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            const data = new Uint8Array(ev2.target.result);\r\n            const workbook = XLSX.read(data, {type: 'array'});\r\n            const process = processWorkbook(workbook);\r\n            const wb = {filename: file.name, workbook, ...process};\r\n            this.sourceBook = wb;\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },\r\n      fileTargetChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          this.rawTarget = null;\r\n          this.target = null;\r\n          const file = ev.target.files[0];\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            this.rawTarget = new Uint8Array(ev2.target.result);\r\n            this.targetFilename = file.name;\r\n            const workbook = XLSX.read(this.rawTarget, {type: 'array'});\r\n            const res = readResultEntries(workbook);\r\n            const data = {name: file.name,\r\n                          lastModified: file.lastModified,\r\n                          date: new Date(file.lastModified),\r\n                          data: res};\r\n            this.targetData = data;\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n      },\r\n       addMutationsChosen(ev) {\r\n        if (ev.target.files[0]) {\r\n          const file = ev.target.files[0];\r\n          console.log(file);\r\n          const reader = new FileReader();\r\n          reader.onload = (ev2) => {\r\n            const data = new Uint8Array(ev2.target.result);\r\n            const workbook = XLSX.read(data, {type: 'array'});\r\n            const res = readResultEntries(workbook);\r\n            const mutation = {name: file.name,\r\n                              lastModified: file.lastModified,\r\n                              date: new Date(file.lastModified),\r\n                              data: res};\r\n            this.mutations.push(mutation);\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        }\r\n        // if (ev.target.files[0]) {\r\n        //   this.rawTarget = null;\r\n        //   this.target = null;\r\n        //   const file = ev.target.files[0];\r\n        //   const reader = new FileReader();\r\n        //   reader.onload = (ev2) => {\r\n        //     this.rawTarget = new Uint8Array(ev2.target.result);\r\n        //     this.targetFilename = file.name;\r\n        //   };\r\n        //   reader.readAsArrayBuffer(file);\r\n       },      \r\n      availableColumnToText(c) {\r\n        //console.log(c);\r\n        if (c.wb && c.wb.filename) {\r\n          return c.wb.filename + ' / ' + c.frame.sheetName + ' / ' + c.column;\r\n        }\r\n        else if (c.frame && c.frame.sheetName && c.column) {\r\n          return 'Unknown Workbook / ' + c.frame.sheetName + ' / ' + c.column;\r\n        }\r\n        else if (c.column) {\r\n          return 'Unknown Workbook / Unknown Sheet / ' + c.column;\r\n        }\r\n        return '[ERROR - Unknown Column]';\r\n      },\r\n      availableColumnToValue(c) {\r\n        return {index: c.index, column: c.column};\r\n      },\r\n      addOutputCol() {\r\n        this.outputColumns.push(\r\n          {\r\n             outputKey: this.availableKeys[0],\r\n             outputColumn: this.availableColumns[0],\r\n             outputName: this.availableColumns[0].column\r\n          }\r\n        );\r\n      },\r\n      updateSourceColumn(newVal, col) {\r\n        col.outputColumn = newVal;\r\n        col.outputName = newVal.column;\r\n      },\r\n      downloadResult() {\r\n        if (this.injectionResults && this.injectionResults.wb) {\r\n          const fname = this.targetFilename.replace('.xlsx','-injected.xlsx');\r\n          XLSX.writeFile(this.injectionResults.wb, fname);\r\n        }\r\n      },\r\n      downloadMissing() {\r\n        if (this.injectionResults && this.injectionResults.missing.length > 0) {\r\n          const table = [['Student','Result']];\r\n          for (let entry of this.injectionResults.missing) {\r\n            table.push([entry.id, entry.result]);\r\n          }\r\n          const fname = this.targetFilename.replace('.xlsx','-missing.xlsx');\r\n          const wb = XLSX.utils.book_new(), ws = XLSX.utils.aoa_to_sheet(table);\r\n          XLSX.utils.book_append_sheet(wb, ws, 'Missing');\r\n          XLSX.writeFile(wb, fname);\r\n        }\r\n      }\r\n    },\r\n    computed: {\r\n      oldResults() {\r\n        // TODO: use date information rather than order?\r\n        let result = {};\r\n        if (this.targetData) {\r\n          result = {...result, ...this.targetData.data.entries};\r\n          console.log(this.targetData);\r\n          for (const mut of this.mutations) {\r\n            console.log(mut);\r\n            result = {...result, ...mut.data.entries};\r\n          }\r\n        }\r\n        return result;\r\n      },\r\n      updatedResults() {\r\n        if (this.selectedColumn) {\r\n          const passAtt = this.attendance && this.useAttendance ? this.attendance : null;\r\n          const rawNewResults = processResult(this.selectedColumn, GradingPolicy, IdentityConfig, passAtt);\r\n          const newResults = rawNewResults.data;\r\n          const allStudents = new Set();\r\n          Object.keys(newResults).forEach(i => allStudents.add(i));\r\n          Object.keys(this.oldResults).forEach(i => allStudents.add(i));\r\n          const result = {};\r\n          for (const student of allStudents) {\r\n            const newValue = newResults[student];\r\n            const newMissing = newValue === undefined || newValue == GradingPolicy.missingValue;\r\n            const oldEntry = this.oldResults[student];\r\n            const oldValue = oldEntry ? oldEntry.result : undefined;\r\n            const oldMissing = oldValue === undefined || oldValue == GradingPolicy.missingValue;\r\n            if (oldValue != newValue) {\r\n              if (newMissing && oldMissing) {\r\n                continue;\r\n              }\r\n              else if (newMissing) {\r\n                result[student] = GradingPolicy.missingValue;\r\n              }\r\n              else {\r\n                result[student] = newValue;\r\n              }\r\n            }\r\n          }\r\n          return result;\r\n        }\r\n        return null;\r\n      },\r\n      injectionResults() {\r\n        if (this.rawTarget && this.updatedResults) {\r\n            try {\r\n              const wb = XLSX.read(this.rawTarget, {type: 'array', cellStyles:true});\r\n              const result = mutateResults(this.updatedResults, wb);\r\n              return result;\r\n            }\r\n            catch (err) {\r\n              console.log(err);\r\n              return {errors: ['Error while processing target spreadsheet: ' + err.message]};\r\n            }\r\n        }\r\n        return null;\r\n      },\r\n      availableColumns() {\r\n        const result = [];\r\n        let idx = 0;\r\n        if (this.sourceBook) {\r\n          for (let frame of this.sourceBook.frames) {\r\n            for (let column of frame.df.columns) {\r\n              result.push({wb: this.sourceBook, frame, column, index: idx++, type: 'df'})\r\n            }\r\n          }\r\n        }\r\n        return result;\r\n      },\r\n      allKeys() {\r\n        let keys = new Set();\r\n        if (this.sourceBook) {\r\n          for (let frame of this.sourceBook.frames) {\r\n            if (frame.includeStudents && this.keyColumn && frame.keys[this.keyColumn]) {\r\n              const kc = frame.keys[this.keyColumn];\r\n              for (let key of kc.keys) {\r\n                keys.add(key);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        keys = Array.from(keys).sort();\r\n        return keys;\r\n      },\r\n      selectedColumn() {\r\n        if (this.sourceColumn) {\r\n          const colIndex = this.sourceColumn.index;\r\n          const col = this.availableColumns[colIndex];\r\n          return col;\r\n        }\r\n        return null;\r\n      },\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n.margin-top {\r\n  margin-top: 1em;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mutator.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mutator.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Mutator.vue?vue&type=template&id=766418c1&scoped=true&\"\nimport script from \"./Mutator.vue?vue&type=script&lang=js&\"\nexport * from \"./Mutator.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Mutator.vue?vue&type=style&index=0&id=766418c1&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"766418c1\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardSubtitle } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VExpansionPanel } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanelContent } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanelHeader } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanels } from 'vuetify/lib/components/VExpansionPanel';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardActions,VCardSubtitle,VCardText,VCardTitle,VCol,VContainer,VExpansionPanel,VExpansionPanelContent,VExpansionPanelHeader,VExpansionPanels,VListItem,VListItemContent,VRow,VSelect,VSwitch})\n","<template>\r\n  <v-app>\r\n    <v-app-bar\r\n      app\r\n      color=\"primary\"\r\n      dark\r\n    >\r\n      <div class=\"d-flex align-center\">\r\n        <h3>ESE Grade Handler</h3>\r\n      </div>\r\n\r\n      <v-spacer></v-spacer>\r\n      <v-btn color=\"error\" @click=\"refresh\">Reset</v-btn>\r\n    </v-app-bar>\r\n\r\n    <v-main>\r\n      <v-tabs centered v-model=\"currentTab\">\r\n        <v-tab>Welcome</v-tab>\r\n        <v-tab>Combiner</v-tab>\r\n        <v-tab>Injector</v-tab>\r\n        <v-tab>Mutator</v-tab>\r\n      </v-tabs>\r\n      <Welcome v-if=\"currentTab == 0\" />\r\n      <Combiner v-else-if=\"currentTab == 1\" />\r\n      <Injector v-else-if=\"currentTab == 2\" />\r\n      <Mutator v-else-if=\"currentTab == 3\" />\r\n    </v-main>\r\n  </v-app>\r\n</template>\r\n\r\n<script>\r\nimport Welcome from './components/Welcome';\r\nimport Combiner from './components/Combiner';\r\nimport Injector from './components/Injector';\r\nimport Mutator from './components/Mutator';\r\n\r\nexport default {\r\n  name: 'App',\r\n\r\n  components: {\r\n    Combiner,\r\n    Injector,\r\n    Welcome,\r\n    Mutator\r\n  },\r\n\r\n  data: () => ({\r\n    currentTab: 0\r\n  }),\r\n  methods: {\r\n    refresh() {\r\n      window.location.reload();\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0cc95957&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VAppBar } from 'vuetify/lib/components/VAppBar';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VMain } from 'vuetify/lib/components/VMain';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTab } from 'vuetify/lib/components/VTabs';\nimport { VTabs } from 'vuetify/lib/components/VTabs';\ninstallComponents(component, {VApp,VAppBar,VBtn,VMain,VSpacer,VTab,VTabs})\n","import Vue from 'vue';\r\nimport Vuetify from 'vuetify/lib';\r\n\r\nVue.use(Vuetify);\r\n\r\nexport default new Vuetify({\r\n});\r\n","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport vuetify from './plugins/vuetify';\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  vuetify,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConditionPanel.vue?vue&type=style&index=0&id=ff8925b2&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mutator.vue?vue&type=style&index=0&id=766418c1&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Injector.vue?vue&type=style&index=0&id=620d0028&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Welcome.vue?vue&type=style&index=0&id=40722623&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttendancePanel.vue?vue&type=style&index=0&id=54ae2d44&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Combiner.vue?vue&type=style&index=0&id=326983c4&scoped=true&lang=css&\""],"sourceRoot":""}